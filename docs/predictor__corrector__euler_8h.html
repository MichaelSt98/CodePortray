<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CodePortray</title>
	<base href="/">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--
	<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=9"/>
	-->
	<meta name="generator" content="Doxygen 1.9.3"/>
	<title>milupHPC: include/integrator/predictor_corrector_euler.h File Reference</title>
	<title>include/integrator/predictor_corrector_euler.h File Reference</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css2?family=Alata&amp;display=swap" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="CodePortray/components/side-nav/styles.css" type="text/css">
	<link rel="stylesheet" href="CodePortray/components/hamburger/styles.css" type="text/css">
	<link rel="stylesheet" href="CodePortray/components/header/styles.css" type="text/css">
	<link rel="stylesheet" href="CodePortray/components/icons/styles.css" type="text/css">
	<link rel="stylesheet" href="CodePortray/components/dialog/styles.css" type="text/css">
	<link rel="stylesheet" href="CodePortray/components/copyable/styles.css" type="text/css">
	<link rel="stylesheet" href="CodePortray/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
	<link href="CodePortray/tabs.css" rel="stylesheet" type="text/css"/>
	<script type="text/javascript" src="CodePortray/jquery.js"></script>
	<script type="text/javascript" src="CodePortray/dynsections.js"></script>
	<!--
	<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
	<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
	<link href="CodePortray/doxygen-custom.css" rel="stylesheet" type="text/css"/>
	-->
	<link href="CodePortray/search/search.css" rel="stylesheet" type="text/css"/>
	<script type="text/javascript" src="CodePortray/search/searchdata.js"></script>
	<script type="text/javascript" src="CodePortray/search/search.js"></script>
	<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
	<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
	<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<custom-header class="custom-header-class">
	<!--<custom-hamburger menu onclick="toggle()"></custom-hamburger>-->
	<a menu href="https://michaelst98.github.io/milupHPC/"><custom-icon icon="home" color="white" background="black"></custom-icon></a>
	<div shortcuts style="display: table">
		<div style="display: table-cell; padding-right: 2px">
			<a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a>
		</div>
		<div style="display: table-cell; padding-right: 2px">
			<a title="Computational physics TÃ¼bingen" href="https://uni-tuebingen.de/en/faculties/faculty-of-science/departments/physics/institutes/astronomy-astrophysics/computational-physics/welcome/"><custom-icon icon="university" color="white" background="#8D2439"></custom-icon></a>
		</div>
		<div style="display: table-cell; padding-right: 2px">
			<a title="Wikipedia: Smoothed particle hydrodynamics" href="https://de.wikipedia.org/wiki/Smoothed_Particle_Hydrodynamics"><custom-icon icon="wikipedia-w" color="black" background="lightgrey"></custom-icon></a>
		</div>
		<div style="display: table-cell; padding-right: 2px">
			<a title="Youtube: CPTuebingen" href="https://www.youtube.com/user/CPTuebingen"><custom-icon icon="youtube" color="white" background="#DB0000"></custom-icon></a>
		</div>
		<!-- get the code ... -->
		<!--<custom-icon url="https://www.google.com" icon="code" color="white" background="black"></custom-icon>-->
		<div style="display: table-cell; padding-right: 2px">
			<custom-dialog window-width="600px" window-height="400px">
				<span open><custom-icon title="Get the code" icon="code" color="white" background="black"></custom-icon></span>
				<div title>Get the code: milupHPC!</div>
				<div style="text-align: center; padding-top: 20px;">
					<div>The code is publicly available on GitHub: <a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a></div>
					<!--<div><a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a></div>-->
					<!--<a href="https://github.com/MichaelSt98/milupHPC">github.com/MichaelSt98/milupHPC</a>-->
					<div style="padding-top: 40px">clone via HTTPS:</div>
					<custom-copyable copy-text="https://github.com/MichaelSt98/milupHPC.git" width="none" height="33px">
						<custom-icon icon="clone" color="white" background="black" size="15px"></custom-icon>
					</custom-copyable>
					<div style="padding-top: 20px">clone via SSH:</div>
					<custom-copyable copy-text="git@github.com:MichaelSt98/milupHPC.git" width="none" height="33px">
						<custom-icon icon="clone" color="white" background="black" size="15px"></custom-icon>
					</custom-copyable>
					<div style="padding-top: 20px">or download as zip: <a href="https://github.com/MichaelSt98/milupHPC/archive/refs/heads/main.zip"><custom-icon icon="file-archive-o" color="white" background="black"></custom-icon></a></div>
					<!--<a href="https://github.com/MichaelSt98/milupHPC/archive/refs/heads/main.zip"><custom-icon icon="file-archive-o" color="white" background="black"></custom-icon></a>-->
				</div>
				<!--<div footer>This is the footer</div>-->
			</custom-dialog>
		</div>
		<!-- end: get the code .... -->
		<div style="display: table-cell; padding-right: 2px">
			<a title="License" href="https://github.com/MichaelSt98/milupHPC/blob/main/LICENSE"><custom-icon icon="balance-scale" color="white" background="#000000"></custom-icon></a>
		</div>
		<!--<a href=""><custom-icon url="https://www.google.com" icon="terminal" color="white" background="black"></custom-icon></a>-->
	</div>
</custom-header>
	<!--
	<custom-side-nav id="side-nav" nav-width="300">
		<custom-icon url="https://www.google.com" icon="code" color="white" background="black"></custom-icon>
		<div>test</div>
	</custom-side-nav>
	-->
	<div id="banner">
		<div class="logo">
			<span class="subtitle">
				milupHPC documentation
			</span>
		</div>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_d7d66074f572da8b6de5df1f86a9e920.html">integrator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle"><div class="title">predictor_corrector_euler.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Predictor Corrector Euler integrator.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="miluphpc_8h_source.html">../miluphpc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="device__predictor__corrector__euler_8cuh_source.html">device_predictor_corrector_euler.cuh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="device__explicit__euler_8cuh_source.html">device_explicit_euler.cuh</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for predictor_corrector_euler.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="predictor__corrector__euler_8h__incl.png" border="0" usemap="#ainclude_2integrator_2predictor__corrector__euler_8h" alt=""/></div>
<map name="ainclude_2integrator_2predictor__corrector__euler_8h" id="ainclude_2integrator_2predictor__corrector__euler_8h">
<area shape="rect" title="Predictor Corrector Euler integrator." alt="" coords="426,5,561,61"/>
<area shape="rect" href="miluphpc_8h.html" title="Right&#45;hand&#45;side implementation and CUDA kernel execution via wrapper functions." alt="" coords="2805,109,2902,136"/>
<area shape="rect" href="device__predictor__corrector__euler_8cuh.html" title="Device functions and kernels for the predictor corrector euler (Heun) integrator." alt="" coords="958,363,1133,404"/>
<area shape="rect" href="device__explicit__euler_8cuh.html" title="Device functions and kernels for the explicit euler integrator." alt="" coords="94,452,261,479"/>
<area shape="rect" href="particle__handler_8h.html" title=" " alt="" coords="3320,370,3443,397"/>
<area shape="rect" title=" " alt="" coords="2611,825,2683,852"/>
<area shape="rect" href="cuda__utilities_8cuh.html" title="CUDA utilities." alt="" coords="1221,601,1408,628"/>
<area shape="rect" title=" " alt="" coords="1399,676,1460,703"/>
<area shape="rect" href="cuda__runtime_8h.html" title="CUDA runtime functionalities and wrappers." alt="" coords="2233,676,2343,703"/>
<area shape="rect" title=" " alt="" coords="355,601,413,628"/>
<area shape="rect" href="include_2utils_2_logger_8h.html" title="C++ style logger." alt="" coords="3449,452,3543,479"/>
<area shape="rect" title=" " alt="" coords="3245,527,3312,553"/>
<area shape="rect" href="tree__handler_8h.html" title="Tree class handler." alt="" coords="2851,363,2994,404"/>
<area shape="rect" title=" " alt="" coords="1480,527,1541,553"/>
<area shape="rect" href="subdomain__handler_8h.html" title="Classes and Kernels handling subdomains that distribute the workload among the MPI processes." alt="" coords="2695,273,2843,315"/>
<area shape="rect" href="helper__handler_8h.html" title=" " alt="" coords="1869,452,1997,479"/>
<area shape="rect" href="device__rhs_8cuh.html" title=" " alt="" coords="539,370,650,397"/>
<area shape="rect" href="timer_8h.html" title="C++ timer based on boost::mpi::timer." alt="" coords="2726,452,2815,479"/>
<area shape="rect" href="material__handler_8h.html" title="Handler for material parameters and settings." alt="" coords="3120,363,3245,404"/>
<area shape="rect" href="gravity_8cuh.html" title="Gravitational force computation functions and CUDA kernels." alt="" coords="379,281,506,307"/>
<area shape="rect" href="sph_8cuh.html" title="SPH related functionalities and kernels." alt="" coords="1259,281,1352,307"/>
<area shape="rect" title=" " alt="" coords="3412,191,3519,218"/>
<area shape="rect" href="h5profiler_8h.html" title="profiler based on (parallel) HDF5" alt="" coords="3274,191,3387,218"/>
<area shape="rect" title=" " alt="" coords="3173,281,3307,307"/>
<area shape="rect" title=" " alt="" coords="3331,281,3493,307"/>
<area shape="rect" title=" " alt="" coords="3843,281,4021,307"/>
<area shape="rect" href="kernel_8cuh.html" title=" " alt="" coords="675,370,781,397"/>
<area shape="rect" href="kernel__handler_8cuh.html" title=" " alt="" coords="200,281,355,307"/>
<area shape="rect" href="density_8cuh.html" title="SPH density calculation." alt="" coords="1216,191,1328,218"/>
<area shape="rect" href="pressure_8cuh.html" title="Pressure calculation in dependence of the equation of states." alt="" coords="1800,370,1923,397"/>
<area shape="rect" href="internal__forces_8cuh.html" title="SPH internal forces." alt="" coords="1528,281,1685,307"/>
<area shape="rect" href="soundspeed_8cuh.html" title="Calculating and initializing the speed of sound in dependence of the used equation of state." alt="" coords="1710,281,1853,307"/>
<area shape="rect" href="simulation__time__handler_8h.html" title="Handler for SimulationTime class." alt="" coords="2427,452,2599,479"/>
<area shape="rect" href="kernels_8cuh.html" title="..." alt="" coords="1947,370,2103,397"/>
<area shape="rect" title=" " alt="" coords="3543,191,3603,218"/>
<area shape="rect" title=" " alt="" coords="3628,191,3703,218"/>
<area shape="rect" title=" " alt="" coords="3727,191,3780,218"/>
<area shape="rect" title=" " alt="" coords="3804,191,3844,218"/>
<area shape="rect" title=" " alt="" coords="3868,191,3935,218"/>
<area shape="rect" title=" " alt="" coords="3959,191,4025,218"/>
<area shape="rect" title=" " alt="" coords="4049,184,4194,225"/>
<area shape="rect" href="include_2parameter_8h.html" title="Settings via preprocessor directives, typedefs, constants, structs." alt="" coords="1913,751,2004,777"/>
<area shape="rect" href="particles_8cuh.html" title="Particle struct as Structure of arrays both instantiable on host and device." alt="" coords="488,527,584,553"/>
<area shape="rect" title=" " alt="" coords="616,676,685,703"/>
<area shape="rect" title=" " alt="" coords="3547,527,3602,553"/>
<area shape="rect" href="tree_8cuh.html" title="Tree related classes, kernels and functions." alt="" coords="893,452,963,479"/>
<area shape="rect" title=" " alt="" coords="2744,527,2848,553"/>
<area shape="rect" href="subdomain_8cuh.html" title="Classes and Kernels handling subdomains that distribute the workload among the MPI processes." alt="" coords="1513,370,1623,397"/>
<area shape="rect" href="material_8cuh.html" title="Material parameters and settings." alt="" coords="1701,452,1795,479"/>
<area shape="rect" href="simulation__time_8cuh.html" title="Simulation time related variables and functions instantiable on device and host." alt="" coords="1115,527,1253,553"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="predictor__corrector__euler_8h__dep__incl.png" border="0" usemap="#ainclude_2integrator_2predictor__corrector__euler_8hdep" alt=""/></div>
<map name="ainclude_2integrator_2predictor__corrector__euler_8hdep" id="ainclude_2integrator_2predictor__corrector__euler_8hdep">
<area shape="rect" title="Predictor Corrector Euler integrator." alt="" coords="89,5,223,61"/>
<area shape="rect" href="predictor__corrector__euler_8cpp.html" title=" " alt="" coords="5,109,157,151"/>
<area shape="rect" href="src_2main_8cpp.html" title=" " alt="" coords="182,117,279,143"/>
</map>
</div>
</div>
<p><a href="predictor__corrector__euler_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_predictor_corrector_euler.html">PredictorCorrectorEuler</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Predictor Corrector Euler integrator. </p>
<p >Predictor Corrector Euler integrator inheriting from the <a class="el" href="class_miluphpc.html" title="MilupHPC class.">Miluphpc</a> class.</p>
<p >Predictor corrector integrators generally consist out of one or multiple predictor steps and a corresponding correction. Since the accelerations needed for correction are determined using the predicted positions of the particles it may happen that particles are moving out of their current domain and do not belong anymore to the same process they belonged to before the prediction step. By the construction of the presented parallelization approach, this would require a subsequent reassigning of those particles. However, this includes the particle exchange between the MPI processes and consequently an inevitable resorting of all particles. Since the information need to be recombined for each particle in order to complete the integration step for the predictor-corrector scheme, the particles would have to be sent back and correctly ordered to align the original particle sorting. This is surely doable but most likely really inefficient in terms of performance.</p>
<p >The reason for the necessity of having the particles on the process they belong to is the correctness of the parallel tree. More precisely the correctness of the pseudo-particles and their COMs and masses, which is a key ingredient of the Barnes-Hut method for calculating the gravitational forces.</p>
<p >However, the <a class="el" href="namespace_s_p_h.html" title="SPH related functions and kernels.">SPH</a> part is not relying on the correctness of the pseudo-particles and the neighbor search using the tree can be performed correctly as long as the pseudo-particle center-of-masses are within the correct cell regarding their location in the tree. Hence, by decoupling gravity it is possible to use the predictor-corrector scheme for <a class="el" href="namespace_s_p_h.html" title="SPH related functions and kernels.">SPH</a> only and allow a temporarily corrupt tree in means of false pseudo-particles avoiding the necessity of assigning the particles to the correct process for the corrector step.</p>
<p >Though, for finding the correct interaction partners for each particle it is necessary to have an additional constraint on the chosen time step. <a class="el" href="class_particles.html" title="Particle(s) class based on SoA (Structur of Arrays).">Particles</a> should not move farther than the half of the search radius used to find the particles to be exchanged.</p>
<dl class="section author"><dt>Author</dt><dd>Michael Staneker </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000011">Bug:</a></b></dt><dd>no known bugs </dd></dl>

<p class="definition">Definition in file <a class="el" href="predictor__corrector__euler_8h_source.html">predictor_corrector_euler.h</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
    <!--
    milupHPC  - include/integrator/predictor_corrector_euler.h File Reference<br />
    Generated on Wed Jun 29 2022 22:58:52 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.9.3
    -->
  </small></address>
</body>
<footer>
  <custom-footer color="white" background="#2E4053">
    <div first>API documentation for milupHPC - a parallel SPH & Barnes-Hut code targeting GPU cluster via CUDA-aware MPI</div>
    <div second>
      <div style="text-align: center">
        <div style="display: inline-block; padding-right: 2px; padding-top: 2px">
          <a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a>
        </div>
        <div style="display: inline-block; padding-right: 2px; padding-top: 2px">
          <a title="Computational physics TÃ¼bingen" href="https://uni-tuebingen.de/en/faculties/faculty-of-science/departments/physics/institutes/astronomy-astrophysics/computational-physics/welcome/"><custom-icon icon="university" color="white" background="#8D2439"></custom-icon></a>
        </div>
        <div style="display: inline-block; padding-right: 2px; padding-top: 2px">
          <a title="Wikipedia: Smoothed particle hydrodynamics" href="https://de.wikipedia.org/wiki/Smoothed_Particle_Hydrodynamics"><custom-icon icon="wikipedia-w" color="black" background="lightgrey"></custom-icon></a>
        </div>
      </div>
    </div>
    <div third>
      milupHPC  - include/integrator/predictor_corrector_euler.h File Reference<br />
      Generated on Wed Jun 29 2022 22:58:52 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.9.3
    </div>
  </custom-footer>
</footer>
<!--
<script src="components/side-nav/runtime.js" type="module"></script><script src="components/side-nav/polyfills.js" type="module"></script><script src="components/side-nav/main.js" type="module"></script>
-->
<script src="CodePortray/components/hamburger/runtime.js" type="text/javascript"></script><script src="CodePortray/components/hamburger/polyfills.js" type="text/javascript"></script><script src="CodePortray/components/hamburger/main.js" type="text/javascript"></script>
<script src="CodePortray/components/header/runtime.js" type="text/javascript"></script><script src="CodePortray/components/header/polyfills.js" type="text/javascript"></script><script src="CodePortray/components/header/main.js" type="text/javascript"></script>
<script src="CodePortray/components/icons/runtime.js" type="text/javascript"></script><script src="CodePortray/components/icons/polyfills.js" type="text/javascript"></script><script src="CodePortray/components/icons/main.js" type="text/javascript"></script>
<script src="CodePortray/components/footer/runtime.js" type="text/javascript"></script><script src="CodePortray/components/footer/polyfills.js" type="text/javascript"></script><script src="CodePortray/components/footer/main.js" type="text/javascript"></script>
<script src="CodePortray/components/dialog/runtime.js" type="text/javascript"></script><script src="CodePortray/components/dialog/polyfills.js" type="text/javascript"></script><script src="CodePortray/components/dialog/main.js" type="text/javascript"></script>
<script src="CodePortray/components/copyable/runtime.js" type="text/javascript"></script><script src="CodePortray/components/copyable/polyfills.js" type="text/javascript"></script><script src="CodePortray/components/copyable/main.js" type="text/javascript"></script>
<!--
<script>
  function toggle() {
    var elem = document.getElementById("side-nav");
    console.log(elem);
    elem.toggleSideNav(false);
  }
</script>
-->
<!--
<script>
  function topFunction() {
    document.body.scrollTop = 0; // For Safari
    document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
  }
</script>
-->
</html>
