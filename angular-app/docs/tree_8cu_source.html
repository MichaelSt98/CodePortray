<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CodePortray</title>
	<base href="/">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--
	<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=9"/>
	-->
	<meta name="generator" content="Doxygen 1.9.3"/>
	<title>milupHPC: src/subdomain_key_tree/tree.cu Source File</title>
	<title>src/subdomain_key_tree/tree.cu Source File</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Alata&amp;display=swap" rel="stylesheet">
	<link rel="stylesheet" href="components/side-nav/styles.css">
	<link rel="stylesheet" href="components/hamburger/styles.css">
	<link rel="stylesheet" href="components/header/styles.css">
	<link rel="stylesheet" href="components/icons/styles.css">
	<link rel="stylesheet" href="components/dialog/styles.css">
	<link rel="stylesheet" href="components/copyable/styles.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href="tabs.css" rel="stylesheet" type="text/css"/>
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="dynsections.js"></script>
	<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
	<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
	<link href="doxygen-custom.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<custom-header class="custom-header-class">
		<!--<custom-hamburger menu onclick="toggle()"></custom-hamburger>-->
		<a menu href=""><custom-icon icon="home" color="white" background="black"></custom-icon></a>
		<div shortcuts style="display: table;">
			<!--<a href=""><custom-icon icon="facebook" color="white" background="#3B5998"></custom-icon></a>-->
			<!--<a href=""><custom-icon icon="twitter" color="white" background="#55ACEE"></custom-icon></a>-->
			<!--<a href=""><custom-icon icon="linkedin" color="white" background="#3B67BE"></custom-icon></a>-->
			<!--<a href=""><custom-icon icon="slack" color="white" background="#421B4B"></custom-icon></a>-->
			<!--<a href=""><custom-icon icon="home" color="white" background="black"></custom-icon></a>-->
			<!--<a href=""><custom-icon icon="cogs" color="white" background="black"></custom-icon></a>-->
			<!--<a href=""><custom-icon icon="bars" color="white" background="black"></custom-icon></a>-->
			<div style="display: table-cell; padding-right: 2px">
				<a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a>
			</div>
			<div style="display: table-cell; padding-right: 2px">
				<a title="Computational physics TÃ¼bingen" href="https://uni-tuebingen.de/en/faculties/faculty-of-science/departments/physics/institutes/astronomy-astrophysics/computational-physics/welcome/"><custom-icon icon="university" color="white" background="#8D2439"></custom-icon></a>
			</div>
			<div style="display: table-cell; padding-right: 2px">
				<a title="Wikipedia: Smoothed particle hydrodynamics" href="https://de.wikipedia.org/wiki/Smoothed_Particle_Hydrodynamics"><custom-icon icon="wikipedia-w" color="black" background="lightgrey"></custom-icon></a>
			</div>
			<div style="display: table-cell; padding-right: 2px">
				<a title="Youtube: CPTuebingen" href="https://www.youtube.com/user/CPTuebingen"><custom-icon icon="youtube" color="white" background="#DB0000"></custom-icon></a>
			</div>
			<div style="display: table-cell; padding-right: 2px">
				<a title="LinkedIn" href=""><custom-icon icon="linkedin" color="white" background="#3B67BE"></custom-icon></a>
			</div>
			<div style="display: table-cell; padding-right: 2px">
				<a title="Slack" href=""><custom-icon icon="slack" color="white" background="#421B4B"></custom-icon></a>
			</div>
			<!-- get the code ... -->
			<!--<custom-icon url="https://www.google.com" icon="code" color="white" background="black"></custom-icon>-->
			<div style="display: table-cell; padding-right: 2px">
				<custom-dialog window-width="600px" window-height="400px">
					<span open><custom-icon title="Get the code" icon="code" color="white" background="black"></custom-icon></span>
					<div title>Get the code: milupHPC!</div>
					<div style="text-align: center; padding-top: 20px;">
						<div>The code is publicly available on GitHub: <a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a></div>
						<!--<div><a title="GitHub: milupHPC" href="https://github.com/MichaelSt98/milupHPC"><custom-icon icon="github" color="white" background="#2A2D32"></custom-icon></a></div>-->
						<!--<a href="https://github.com/MichaelSt98/milupHPC">github.com/MichaelSt98/milupHPC</a>-->
						<div style="padding-top: 40px">clone via HTTPS:</div>
						<custom-copyable copy-text="https://github.com/MichaelSt98/milupHPC.git" width="none" height="33px">
							<custom-icon icon="clone" color="white" background="black" size="15px"></custom-icon>
						</custom-copyable>
						<div style="padding-top: 20px">clone via SSH:</div>
						<custom-copyable copy-text="git@github.com:MichaelSt98/milupHPC.git" width="none" height="33px">
							<custom-icon icon="clone" color="white" background="black" size="15px"></custom-icon>
						</custom-copyable>
						<div style="padding-top: 20px">or download as zip: <a href="https://github.com/MichaelSt98/milupHPC/archive/refs/heads/main.zip"><custom-icon icon="file-archive-o" color="white" background="black"></custom-icon></a></div>
						<!--<a href="https://github.com/MichaelSt98/milupHPC/archive/refs/heads/main.zip"><custom-icon icon="file-archive-o" color="white" background="black"></custom-icon></a>-->
					</div>
					<!--<div footer>This is the footer</div>-->
				</custom-dialog>
			</div>
			<!-- end: get the code .... -->
			<!-- share -->
			<!--<custom-icon url="https://www.google.com" icon="share-alt" color="white" background="darkgrey"></custom-icon>-->
			<div style="display: table-cell; padding-right: 2px">
				<custom-dialog window-width="600px" window-height="400px">
					<span open><custom-icon title="About" icon="info" color="white" background="darkgrey"></custom-icon></span>
					<div title>Info</div>
					<div style="text-align: center; padding-top: 50px;">
						<div>Some information about the project</div>
						<div>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.  Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, At accusam aliquyam diam diam dolore dolores duo eirmod eos erat, et nonumy sed tempor et et invidunt justo labore Stet clita ea et gubergren, kasd magna no rebum. sanctus sea sed takimata ut vero voluptua. est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat. Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus.</div>
					</div>
				</custom-dialog>
			</div>
			<!-- end: share -->
			<div style="display: table-cell; padding-right: 2px">
				<a title="License" href="https://github.com/MichaelSt98/milupHPC/blob/main/LICENSE"><custom-icon icon="balance-scale" color="white" background="#000000"></custom-icon></a>
			</div>
			<div style="display: table-cell; padding-right: 2px">
				<custom-dialog window-width="600px" window-height="400px">
					<span open><custom-icon title="Share" icon="share-alt" color="white" background="darkgrey"></custom-icon></span>
					<div title>Contact and share!</div>
					<div style="text-align: center; padding-top: 50px;">
						<div style="display: table; align-content: center; text-align: center; margin: 0 auto;"> <!--  background: #b0b0b0; width: 90%; -->
							<div style="display: table-cell; padding-right: 2px;">
								<a href="mailto:?subject=Check out milupHPC!&amp;body=Check out this site http://www.website.com." title="Share by Email"><custom-icon icon="envelope" background="black" color="white"></custom-icon></a>
							</div>
							<div style="display: table-cell; padding-right: 2px;">
								<span onclick="window.open('http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.nameoftheproject.com'); return false"><custom-icon icon="linkedin" color="white" background="#3B67BE"></custom-icon></span>
							</div>
							<div style="display: table-cell; padding-right: 2px;">
								<a href="whatsapp://send?text=The text to share!" data-action="share/whatsapp/share"><custom-icon icon="whatsapp" color="white" background="#25D366"></custom-icon></a>
							</div>
							<div style="display: table-cell; padding-right: 2px;">
								<a href="https://telegram.me/share/url?url=www.google.com&text=Text to be shared!"><custom-icon icon="telegram" color="white" background="#0088CC"></custom-icon></a>
							</div>
							<div style="display: table-cell; padding-right: 2px;">
								<a href="http://www.reddit.com/submit?url=www.google.com&title=Title%20of%20sharing"><custom-icon icon="reddit" color="#FF5700" background="white"></custom-icon></a>
							</div>
							<div style="display: table-cell; padding-right: 2px;">
								<!-- need to be extended via https://stackoverflow.com/questions/468881/print-div-id-printarea-div-only -->
								<span onclick="window.print();return false;"><custom-icon icon="print" color="white" background="black"></custom-icon></span>
							</div>
							<!--<span onclick="window.open('https://twitter.com/share?url=https://www.nameoftheproject.com'); return false">-->
							<!--<a title="Share by Email"><a href=""><custom-icon icon="bars" color="white" background="black"></custom-icon></a>-->
						</div>
						<div>GitHub: Issues ... </div>
						<div>GitHub: Pull requests ...</div>
						<div>GitHub: Discussions ...</div>
						<div><a href=""><custom-icon icon="linkedin" color="white" background="#3B67BE"></custom-icon></a></div>
					</div>
				</custom-dialog>
			</div>
			<!--<a href=""><custom-icon url="https://www.google.com" icon="terminal" color="white" background="black"></custom-icon></a>-->
		</div>
	</custom-header>
	<!--
	<custom-side-nav id="side-nav" nav-width="300">
		<custom-icon url="https://www.google.com" icon="code" color="white" background="black"></custom-icon>
		<div>test</div>
	</custom-side-nav>
	-->
	<div id="banner">
		<div class="logo">
			<span class="subtitle">
				milupHPC documentation
			</span>
		</div>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_efc95fb01bb841695fd57a4839ea037d.html">subdomain_key_tree</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">tree.cu</div></div>
</div><!--header-->
<div class="contents">
<a href="tree_8cu.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;../../include/subdomain_key_tree/tree.cuh&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &quot;../../include/cuda_utils/cuda_launcher.cuh&quot;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno"><a class="line" href="namespace_key_n_s.html#a7c5eec9fc6ce62a2b5f0f5ecc5c1f38f">    4</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> <a class="code hl_function" href="namespace_key_n_s.html#a7c5eec9fc6ce62a2b5f0f5ecc5c1f38f">KeyNS::lebesgue2hilbert</a>(<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> lebesgue, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> maxLevel) {</div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>    <span class="comment">//keyType hilbert = 0UL;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>    <span class="comment">//integer dir = 0;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>    <span class="comment">//for (integer lvl=maxLevel; lvl&gt;0; lvl--) {</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    <span class="comment">//    keyType cell = (lebesgue &gt;&gt; ((lvl-1)*DIM)) &amp; (keyType)((1&lt;&lt;DIM)-1);</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>    <span class="comment">//    hilbert = hilbert &lt;&lt; DIM;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>    <span class="comment">//    if (lvl &gt; 0) {</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>    <span class="comment">//        hilbert += HilbertTable[dir][cell];</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    <span class="comment">//    }</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    <span class="comment">//    dir = DirTable[dir][cell];</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>    <span class="comment">//}</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    <span class="comment">//return hilbert;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> hilbert = 1UL;</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keywordtype">int</span> level = 0, dir = 0;</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> tmp=lebesgue; tmp&gt;1; level++) {</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>        tmp&gt;&gt;=<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    }</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="keywordflow">if</span> (level == 0) {</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>        hilbert = 0UL;</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    }</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <span class="keywordflow">for</span> (; level&gt;0; level--) {</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>        <span class="keywordtype">int</span> cell = (lebesgue &gt;&gt; ((level-1)*<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>)) &amp; ((1&lt;&lt;<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>)-1);</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        hilbert = (hilbert&lt;&lt;<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>) + <a class="code hl_variable" href="namespace_key_n_s.html#a25cf68b21e9c4eaebaba93ae8f462433">HilbertTable</a>[dir][cell];</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        dir = DirTable[dir][cell];</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    }</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    <span class="comment">//if (lebesgue == 0UL) {</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="comment">//    printf(&quot;HERE: lebesgue = %lu --&gt; level = %i, hilbert = %lu\n&quot;, lebesgue, rememberLevel, hilbert);</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    <span class="comment">//}</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="keywordflow">return</span> hilbert;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>}</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno"><a class="line" href="namespace_key_n_s.html#a0143408931358edd09cd87519c6d34f5">   40</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> <a class="code hl_function" href="namespace_key_n_s.html#a7c5eec9fc6ce62a2b5f0f5ecc5c1f38f">KeyNS::lebesgue2hilbert</a>(<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> lebesgue, <span class="keywordtype">int</span> maxLevel, <span class="keywordtype">int</span> level) {</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> hilbert = 0UL; <span class="comment">// 0UL is our root, placeholder bit omitted</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keywordtype">int</span> dir = 0;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lvl=maxLevel; lvl&gt;0; lvl--) {</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        <span class="keywordtype">int</span> cell = (lebesgue &gt;&gt; ((lvl-1)*<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>)) &amp; (<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a>)((1&lt;&lt;<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>)-1);</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        hilbert = hilbert&lt;&lt;<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keywordflow">if</span> (lvl&gt;maxLevel-level) {</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            hilbert += <a class="code hl_variable" href="namespace_key_n_s.html#a25cf68b21e9c4eaebaba93ae8f462433">HilbertTable</a>[dir][cell];</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        }</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>        dir = DirTable[dir][cell];</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    }</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    <span class="keywordflow">return</span> hilbert;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>}</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="class_tree.html#a7ce9a900d5e647999b0e3c2d5b566672">   55</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_function" href="class_tree.html#a7ce9a900d5e647999b0e3c2d5b566672">Tree::Tree</a>() {</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>}</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="class_tree.html#a4bcc272727b91517221b2ebd7b29c770">   59</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_function" href="class_tree.html#a7ce9a900d5e647999b0e3c2d5b566672">Tree::Tree</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>                                <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX) : count(count),</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>                                start(start), child(child), sorted(sorted), index(index), toDeleteLeaf(toDeleteLeaf),</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>                                toDeleteNode(toDeleteNode), minX(minX), maxX(maxX) {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>}</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno"><a class="line" href="class_tree.html#ae1892b6c0acefa854e967f2db131d5c2">   65</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <span class="keywordtype">void</span> <a class="code hl_function" href="class_tree.html#ae1892b6c0acefa854e967f2db131d5c2">Tree::set</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX) {</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    this-&gt;count = <a class="code hl_variable" href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">count</a>;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    this-&gt;start = <a class="code hl_variable" href="class_tree.html#ab545804f011618ffa1f64eeecaf9c6fd">start</a>;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    this-&gt;child = <a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    this-&gt;sorted = <a class="code hl_variable" href="class_tree.html#a4fce84d240622d3f8522a94e2f34bfa5">sorted</a>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    this-&gt;index = <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    this-&gt;toDeleteNode = <a class="code hl_variable" href="class_tree.html#a6ce0658dd67aa1fee4b20ce7d6594195">toDeleteNode</a>;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    this-&gt;toDeleteLeaf = <a class="code hl_variable" href="class_tree.html#ad7860987146e9bd8dfaded17753de0de">toDeleteLeaf</a>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    this-&gt;minX = <a class="code hl_variable" href="class_tree.html#ab1b9d3e011a5a8648845a3c1cd3ae4a6">minX</a>;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    this-&gt;maxX = <a class="code hl_variable" href="class_tree.html#a4b1617063a347bfa32e3b2f51252ffc5">maxX</a>;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>}</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="class_tree.html#a01125d9b007d2d9a0b51901007323b0a">   80</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_function" href="class_tree.html#a7ce9a900d5e647999b0e3c2d5b566672">Tree::Tree</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index,</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                                <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY,</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                                <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY) : count(count), start(start), child(child), sorted(sorted), index(index),</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>                                toDeleteLeaf(toDeleteLeaf), toDeleteNode(toDeleteNode), minX(minX), maxX(maxX),</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>                                minY(minY), maxY(maxY) {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>}</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="class_tree.html#a64a29850237a4f58e91b100f025f343e">   87</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <span class="keywordtype">void</span> <a class="code hl_function" href="class_tree.html#ae1892b6c0acefa854e967f2db131d5c2">Tree::set</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX,</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY) {</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    this-&gt;count = <a class="code hl_variable" href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">count</a>;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    this-&gt;start = <a class="code hl_variable" href="class_tree.html#ab545804f011618ffa1f64eeecaf9c6fd">start</a>;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    this-&gt;child = <a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    this-&gt;sorted = <a class="code hl_variable" href="class_tree.html#a4fce84d240622d3f8522a94e2f34bfa5">sorted</a>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    this-&gt;index = <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    this-&gt;toDeleteNode = <a class="code hl_variable" href="class_tree.html#a6ce0658dd67aa1fee4b20ce7d6594195">toDeleteNode</a>;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    this-&gt;toDeleteLeaf = <a class="code hl_variable" href="class_tree.html#ad7860987146e9bd8dfaded17753de0de">toDeleteLeaf</a>;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    this-&gt;minX = <a class="code hl_variable" href="class_tree.html#ab1b9d3e011a5a8648845a3c1cd3ae4a6">minX</a>;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    this-&gt;maxX = <a class="code hl_variable" href="class_tree.html#a4b1617063a347bfa32e3b2f51252ffc5">maxX</a>;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    this-&gt;minY = <a class="code hl_variable" href="class_tree.html#af57a288ef4dfcb575f740937153ad3e4">minY</a>;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    this-&gt;maxY = <a class="code hl_variable" href="class_tree.html#aed457bbacc5a2dfdccd18c2f4deb8f6e">maxY</a>;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>}</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="class_tree.html#a03d6f6b06f8bbe41d2775729a5a0f37c">  104</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_function" href="class_tree.html#a7ce9a900d5e647999b0e3c2d5b566672">Tree::Tree</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index,</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                                <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode,</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                                <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minZ, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxZ) : count(count),</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                                start(start), child(child), sorted(sorted), index(index), toDeleteLeaf(toDeleteLeaf),</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                                toDeleteNode(toDeleteNode), minX(minX), maxX(maxX), minY(minY), maxY(maxY), minZ(minZ),</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                                maxZ(maxZ) {</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>}</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="class_tree.html#adff2eeaa85475a2735c3af271e9de789">  112</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <span class="keywordtype">void</span> <a class="code hl_function" href="class_tree.html#ae1892b6c0acefa854e967f2db131d5c2">Tree::set</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                                        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minZ, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxZ) {</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    this-&gt;count = <a class="code hl_variable" href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">count</a>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    this-&gt;start = <a class="code hl_variable" href="class_tree.html#ab545804f011618ffa1f64eeecaf9c6fd">start</a>;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    this-&gt;child = <a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    this-&gt;sorted = <a class="code hl_variable" href="class_tree.html#a4fce84d240622d3f8522a94e2f34bfa5">sorted</a>;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    this-&gt;index = <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    this-&gt;toDeleteNode = <a class="code hl_variable" href="class_tree.html#a6ce0658dd67aa1fee4b20ce7d6594195">toDeleteNode</a>;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    this-&gt;toDeleteLeaf = <a class="code hl_variable" href="class_tree.html#ad7860987146e9bd8dfaded17753de0de">toDeleteLeaf</a>;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    this-&gt;minX = <a class="code hl_variable" href="class_tree.html#ab1b9d3e011a5a8648845a3c1cd3ae4a6">minX</a>;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    this-&gt;maxX = <a class="code hl_variable" href="class_tree.html#a4b1617063a347bfa32e3b2f51252ffc5">maxX</a>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    this-&gt;minY = <a class="code hl_variable" href="class_tree.html#af57a288ef4dfcb575f740937153ad3e4">minY</a>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    this-&gt;maxY = <a class="code hl_variable" href="class_tree.html#aed457bbacc5a2dfdccd18c2f4deb8f6e">maxY</a>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    this-&gt;minZ = <a class="code hl_variable" href="class_tree.html#a27424a8982b78a175d450e507226e19b">minZ</a>;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    this-&gt;maxZ = <a class="code hl_variable" href="class_tree.html#afdff02189752a33f8463f55bf6f58ec0">maxZ</a>;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>}</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="class_tree.html#a134f2cb7fb4402ff7e84e272fe85dccd">  133</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <span class="keywordtype">void</span> <a class="code hl_function" href="class_tree.html#a134f2cb7fb4402ff7e84e272fe85dccd">Tree::reset</a>(<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n) {</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="preprocessor">#if DIM == 1</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="preprocessor">    #pragma unroll 2</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="preprocessor">#elif DIM == 2</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="preprocessor">    #pragma unroll 4</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="preprocessor">    #pragma unroll 8</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        <span class="comment">// reset child indices</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        <a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a> * <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> + i] = -1;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    }</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="comment">// reset counter in dependence of being a node or a leaf</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a> &lt; n) {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <a class="code hl_variable" href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">count</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] = 1;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        <a class="code hl_variable" href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">count</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] = 0;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="comment">// reset start</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <a class="code hl_variable" href="class_tree.html#ab545804f011618ffa1f64eeecaf9c6fd">start</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] = -1;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_variable" href="class_tree.html#a4fce84d240622d3f8522a94e2f34bfa5">sorted</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] = 0;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>}</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="class_tree.html#a3ece229873458b3cdfcebc3e23bb5abd">  157</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> <a class="code hl_function" href="class_tree.html#a3ece229873458b3cdfcebc3e23bb5abd">Tree::getParticleKey</a>(<a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> maxLevel,</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                                                  <a class="code hl_enumeration" href="struct_curve.html#a4269858acf8d67e3cd222466771848b9">Curve::Type</a> curveType) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> level = 0;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> particleKey = (<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a>)0;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> sonBox;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> min_x = *<a class="code hl_variable" href="class_tree.html#ab1b9d3e011a5a8648845a3c1cd3ae4a6">minX</a>;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> max_x = *<a class="code hl_variable" href="class_tree.html#a4b1617063a347bfa32e3b2f51252ffc5">maxX</a>;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> min_y = *<a class="code hl_variable" href="class_tree.html#af57a288ef4dfcb575f740937153ad3e4">minY</a>;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> max_y = *<a class="code hl_variable" href="class_tree.html#aed457bbacc5a2dfdccd18c2f4deb8f6e">maxY</a>;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> min_z = *<a class="code hl_variable" href="class_tree.html#a27424a8982b78a175d450e507226e19b">minZ</a>;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> max_z = *<a class="code hl_variable" href="class_tree.html#afdff02189752a33f8463f55bf6f58ec0">maxZ</a>;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> particleLevel;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> particleLevelTemp = 0;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> childIndex = 0;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="comment">// calculate path to the particle&#39;s position assuming an (oct-)tree with above bounding boxes</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keywordflow">while</span> (level &lt;= maxLevel) {</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        sonBox = 0;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        <span class="comment">// find insertion point for body</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] &lt; 0.5 * (min_x + max_x)) {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            sonBox += 1;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>            max_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        }</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <span class="keywordflow">else</span> { min_x = 0.5 * (min_x + max_x); }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] &lt; 0.5 * (min_y+max_y)) {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            sonBox += 2;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>            max_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <span class="keywordflow">else</span> { min_y = 0.5 * (min_y + max_y); }</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>] &lt; 0.5 * (min_z+max_z)) {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            sonBox += 4;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>            max_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        }</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <span class="keywordflow">else</span> { min_z =  0.5 * (min_z + max_z); }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        particleKey = particleKey | ((<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a>)sonBox &lt;&lt; (<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a>)(<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> * (maxLevel-level-1)));</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        level++;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        particleLevelTemp++;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="keywordflow">if</span> (childIndex == <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>) {</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>            particleLevel = particleLevelTemp;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        <span class="comment">//for (int i_child = 0; i_child &lt; POW_DIM; i_child++) {</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="comment">//    if (child[POW_DIM * childIndex + i_child] == index) {</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        <span class="comment">//        printf(&quot;found index = %i for child[8 * %i + %i] = %i\n&quot;, index, childIndex, i_child, child[POW_DIM * childIndex + i_child]);</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        <span class="comment">//        break;</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        <span class="comment">//    }</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="comment">//}</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        childIndex = <a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * childIndex + sonBox];</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="comment">//if (particleLevel == 0) {</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="comment">//    printf(&quot;particleLevel = %i particleLevelTemp = %i index = %i (%f, %f, %f)\n&quot;, particleLevel, particleLevelTemp, index,</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <span class="comment">//           particles-&gt;x[index], particles-&gt;y[index], particles-&gt;z[index]);</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="comment">//}</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="comment">//if (particleKey == 0UL) {</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="comment">//    printf(&quot;Why key = %lu? x = (%f, %f, %f) min = (%f, %f, %f), max = (%f, %f, %f)\n&quot;, particleKey,</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <span class="comment">//           particles-&gt;x[index], particles-&gt;y[index], particles-&gt;z[index],</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="comment">//           *minX, *minY, *minZ, *maxX, *maxY, *maxZ);</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="comment">//}</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="keywordflow">switch</span> (curveType) {</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="struct_curve.html#a4269858acf8d67e3cd222466771848b9a5a99c9b25c007209b664b9d9742a93de">Curve::lebesgue</a>: {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            <span class="keywordflow">return</span> particleKey;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        }</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="struct_curve.html#a4269858acf8d67e3cd222466771848b9aa4755aa9be875092afb3b8ec3fe8599a">Curve::hilbert</a>: {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_key_n_s.html#a7c5eec9fc6ce62a2b5f0f5ecc5c1f38f">KeyNS::lebesgue2hilbert</a>(particleKey, maxLevel, maxLevel);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            <span class="comment">//return KeyNS::lebesgue2hilbert(particleKey, maxLevel);</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            printf(<span class="stringliteral">&quot;Curve type not available!\n&quot;</span>);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>            <span class="keywordflow">return</span> (<a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a>)0;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>}</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno"><a class="line" href="class_tree.html#adaf45c28a56b1cabf9b41a2c27f10200">  242</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_function" href="class_tree.html#adaf45c28a56b1cabf9b41a2c27f10200">Tree::getTreeLevel</a>(<a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> maxLevel,</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                                                <a class="code hl_enumeration" href="struct_curve.html#a4269858acf8d67e3cd222466771848b9">Curve::Type</a> curveType) {</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> key = <a class="code hl_function" href="class_tree.html#a3ece229873458b3cdfcebc3e23bb5abd">getParticleKey</a>(particles, <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>, maxLevel); <span class="comment">//, curveType); //TODO: hilbert working for lebesgue: why???</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> level = 0;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> childIndex;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> path[<a class="code hl_define" href="parameter_8h.html#a5bb4257ca9fa4bfcf9391b7895b97761">MAX_LEVEL</a>];</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i=0; i&lt;maxLevel; i++) {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        path[i] = (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>) (key &gt;&gt; (maxLevel * <a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> - <a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> * (i + 1)) &amp; (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a>)(<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> - 1));</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        <span class="comment">//printf(&quot;path[%i] = %i\n&quot;, i, path[i]);</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    }</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    childIndex = 0;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i=0; i&lt;maxLevel; i++) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        level++;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <span class="keywordflow">if</span> (childIndex == <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>) {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            <span class="keywordflow">return</span> level;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        childIndex = <a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * childIndex + path[i]];</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    }</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="preprocessor">#if SAFETY_LEVEL &gt; 1</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    printf(<span class="stringliteral">&quot;ATTENTION: level = -1 (index = %i x = (%f, %f, %f) %f) tree index = %i\n&quot;</span>,</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>           <a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>], particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>], particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>], particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="class_tree.html#a142119232057402f36976ea7b4870b9e">index</a>], *this-&gt;index);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="comment">//for (integer i=0; i&lt;maxLevel; i++) {</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <span class="comment">//    childIndex = child[POW_DIM * childIndex + path[i]];</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <span class="comment">//    for (int k=0; k&lt;8; k++) {</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="comment">//        if (child[POW_DIM * childIndex + k] == index) {</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="comment">//            printf(&quot;FOUND index = %i in level %i for child = %i x = (%f, %f, %f) ((%i, %i), (%i, %i))\n&quot;, index, i, k,</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <span class="comment">//                   particles-&gt;x[index], particles-&gt;y[index], particles-&gt;z[index],</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">//                   toDeleteLeaf[0], toDeleteLeaf[1], toDeleteNode[0], toDeleteNode[1]);</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="comment">//        }</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="comment">//    }</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="comment">//    //printf(&quot;index = %i, path[%i] = %i, childIndex = %i\n&quot;, index, i, path[i], childIndex);</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="comment">//}</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>}</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">//TODO: is this still working? since count only used within buildTree (probably yes)</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno"><a class="line" href="class_tree.html#a6c2387d721990c777a77af311ad3209d">  288</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_function" href="class_tree.html#a6c2387d721990c777a77af311ad3209d">Tree::sumParticles</a>() {</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_function" href="class_tree.html#a6c2387d721990c777a77af311ad3209d">sumParticles</a> = 0;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="comment">// sum over first level tree count values</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        <a class="code hl_function" href="class_tree.html#a6c2387d721990c777a77af311ad3209d">sumParticles</a> += <a class="code hl_variable" href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">count</a>[<a class="code hl_variable" href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">child</a>[i]];</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    printf(<span class="stringliteral">&quot;sumParticles = %i\n&quot;</span>, <a class="code hl_function" href="class_tree.html#a6c2387d721990c777a77af311ad3209d">sumParticles</a>);</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="class_tree.html#a6c2387d721990c777a77af311ad3209d">sumParticles</a>;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>}</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno"><a class="line" href="class_tree.html#a7b5f04ad2e40fd4a4411a48316d6a45a">  298</a></span><a class="code hl_define" href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a> <a class="code hl_function" href="class_tree.html#a7b5f04ad2e40fd4a4411a48316d6a45a">Tree::~Tree</a>() {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>}</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a3fc2ba2061d44f078127d7d0461e0bd9">  302</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a3fc2ba2061d44f078127d7d0461e0bd9">TreeNS::Kernel::computeBoundingBox</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *mutex, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n,</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>                                                 <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> blockSize) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> index = threadIdx.x + blockDim.x * blockIdx.x;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> x_min = particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[index];</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> x_max = particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[index];</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> y_min = particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[index];</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> y_max = particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[index];</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z_min = particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[index];</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z_max = particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[index];</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <span class="keyword">extern</span> __shared__ <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> buffer[];</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* x_min_buffer = (<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>*)buffer;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* x_max_buffer = (<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>*)&amp;x_min_buffer[blockSize];</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* y_min_buffer = (<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>*)&amp;x_max_buffer[blockSize];</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* y_max_buffer = (<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>*)&amp;y_min_buffer[blockSize];</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* z_min_buffer = (<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>*)&amp;y_max_buffer[blockSize];</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* z_max_buffer = (<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>*)&amp;z_min_buffer[blockSize];</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = stride;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="comment">// find (local) min/max</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="keywordflow">while</span> (index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> &lt; n) {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        x_min = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(x_min, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        x_max = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(x_max, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        y_min = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(y_min, particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        y_max = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(y_max, particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        z_min = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(z_min, particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        z_max = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(z_max, particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[index + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    }</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="comment">// save value in corresponding buffer</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    x_min_buffer[threadIdx.x] = x_min;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    x_max_buffer[threadIdx.x] = x_max;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    y_min_buffer[threadIdx.x] = y_min;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    y_max_buffer[threadIdx.x] = y_max;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    z_min_buffer[threadIdx.x] = z_min;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    z_max_buffer[threadIdx.x] = z_max;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <span class="comment">// synchronize threads / wait for unfinished threads</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    __syncthreads();</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i = blockDim.x/2; <span class="comment">// assuming blockDim.x is a power of 2!</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="comment">// reduction within block</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="keywordflow">while</span> (i != 0) {</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        <span class="keywordflow">if</span> (threadIdx.x &lt; i) {</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            x_min_buffer[threadIdx.x] = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(x_min_buffer[threadIdx.x], x_min_buffer[threadIdx.x + i]);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            x_max_buffer[threadIdx.x] = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(x_max_buffer[threadIdx.x], x_max_buffer[threadIdx.x + i]);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            y_min_buffer[threadIdx.x] = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(y_min_buffer[threadIdx.x], y_min_buffer[threadIdx.x + i]);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>            y_max_buffer[threadIdx.x] = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(y_max_buffer[threadIdx.x], y_max_buffer[threadIdx.x + i]);</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            z_min_buffer[threadIdx.x] = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(z_min_buffer[threadIdx.x], z_min_buffer[threadIdx.x + i]);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>            z_max_buffer[threadIdx.x] = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(z_max_buffer[threadIdx.x], z_max_buffer[threadIdx.x + i]);</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        __syncthreads();</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        i /= 2;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="comment">// combining the results and generate the root cell</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="keywordflow">if</span> (threadIdx.x == 0) {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        <span class="keywordflow">while</span> (atomicCAS(mutex, 0 ,1) != 0); <span class="comment">// lock</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX, x_min_buffer[0]);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX, x_max_buffer[0]);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY, y_min_buffer[0]);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY, y_max_buffer[0]);</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span><span class="preprocessor">#if CUBIC_DOMAINS</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <span class="keywordflow">if</span> (*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY &lt; *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX) {</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        }</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        }</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="keywordflow">if</span> (*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY &gt; *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX) {</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        }</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        }</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a>(*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ, z_min_buffer[0]);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ = <a class="code hl_function" href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a>(*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ, z_max_buffer[0]);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="preprocessor">#if CUBIC_DOMAINS</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        <span class="keywordflow">if</span> (*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ &lt; *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX) {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        }</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        }</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        <span class="keywordflow">if</span> (*<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ &gt; *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX) {</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        atomicExch(mutex, 0); <span class="comment">// unlock</span></div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>}</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span><span class="comment">// just a wrapper for the member function</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a528859bf46a47a236eb3380e4883b3d9">  440</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a528859bf46a47a236eb3380e4883b3d9">TreeNS::Kernel::sumParticles</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>) {</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    <span class="keywordflow">if</span> (bodyIndex == 0) {</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a528859bf46a47a236eb3380e4883b3d9">sumParticles</a> = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;sumParticles();</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        printf(<span class="stringliteral">&quot;sumParticles = %i\n&quot;</span>, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a528859bf46a47a236eb3380e4883b3d9">sumParticles</a>);</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    }</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>}</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno"><a class="line" href="tree_8cu.html#a5bb40d18dc6b963688fd0db2f9c963b3">  452</a></span><span class="preprocessor">#define COMPUTE_DIRECTLY 0</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#aba9c2fd609640bbaf1833fb6a7a8b4ff">  454</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#aba9c2fd609640bbaf1833fb6a7a8b4ff">TreeNS::Kernel::buildTree</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    <span class="comment">//note: -1 used as &quot;null pointer&quot;</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <span class="comment">//note: -2 used to lock a child (pointer)</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="keywordtype">int</span> level;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="keywordtype">bool</span> newBody = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> min_x;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> max_x;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> x;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> y;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> min_y;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> max_y;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> min_z;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> max_z;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span> </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> childPath;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> temp;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="keywordflow">while</span> ((bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>) &lt; n) {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <span class="keywordflow">if</span> (newBody) {</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            newBody = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            level = 0;</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            <span class="comment">// copy bounding box(es)</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            min_x = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minX;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            max_x = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxX;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>            x = particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>            y = particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>            min_y = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minY;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>            max_y = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxY;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            z = particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>            min_z = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;minZ;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            max_z = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;maxZ;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>            temp = 0;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            childPath = 0;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>            <span class="comment">// find insertion point for body</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            <span class="comment">// x direction</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>            <span class="keywordflow">if</span> (x &lt; 0.5 * (min_x + max_x)) { <span class="comment">// x direction</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                childPath += 1;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                max_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            }</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                min_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>            }</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>            <span class="comment">// y direction</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>            <span class="keywordflow">if</span> (y &lt; 0.5 * (min_y + max_y)) { <span class="comment">// y direction</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>                childPath += 2;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>                max_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            }</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                min_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>            }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            <span class="comment">// z direction</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            <span class="keywordflow">if</span> (z &lt; 0.5 * (min_z + max_z)) {  <span class="comment">// z direction</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                childPath += 4;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                max_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                min_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> childIndex = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[temp*<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> + childPath];</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="comment">// traverse tree until hitting leaf node</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        <span class="keywordflow">while</span> (childIndex &gt;= m) { <span class="comment">//n</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>            temp = childIndex;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>            level++;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>            childPath = 0;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>            <span class="comment">// find insertion point for body</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>            <span class="keywordflow">if</span> (x &lt; 0.5 * (min_x + max_x)) { <span class="comment">// x direction</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>                childPath += 1;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                max_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>            }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                min_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>            }</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>            <span class="keywordflow">if</span> (y &lt; 0.5 * (min_y + max_y)) { <span class="comment">// y direction</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                childPath += 2;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                max_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>            }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>                min_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>            }</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>            <span class="keywordflow">if</span> (z &lt; 0.5 * (min_z + max_z)) { <span class="comment">// z direction</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>                childPath += 4;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>                max_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>            }</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>                min_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>            }</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span><span class="preprocessor">#if COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>            <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] != 0) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>                <span class="comment">//particles-&gt;x[temp] += particles-&gt;weightedEntry(bodyIndex + offset, Entry::x);</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>                atomicAdd(&amp;particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[temp], particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4">Entry::x</a>));</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>                <span class="comment">//particles-&gt;y[temp] += particles-&gt;weightedEntry(bodyIndex + offset, Entry::y);</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>                atomicAdd(&amp;particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[temp], particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b">Entry::y</a>));</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>                <span class="comment">//particles-&gt;z[temp] += particles-&gt;weightedEntry(bodyIndex + offset, Entry::z);</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>                atomicAdd(&amp;particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[temp], particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26">Entry::z</a>));</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            }</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span> </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            <span class="comment">//particles-&gt;mass[temp] += particles-&gt;mass[bodyIndex + offset];</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            atomicAdd(&amp;particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[temp], particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="preprocessor">#endif </span><span class="comment">// COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            atomicAdd(&amp;<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[temp], 1);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            childIndex = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * temp + childPath];</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>        }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <span class="comment">// if child is not locked</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <span class="keywordflow">if</span> (childIndex != -2) {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> locked = temp * <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> + childPath;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>            <span class="keywordflow">if</span> (atomicCAS(&amp;<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[locked], childIndex, -2) == childIndex) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span> </div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>                <span class="comment">// check whether a body is already stored at the location</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>                <span class="keywordflow">if</span> (childIndex == -1) {</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>                    <span class="comment">//insert body and release lock</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>                    <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[locked] = bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                    particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] = level + 1;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span> </div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>                }</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>                    <span class="keywordflow">if</span> (childIndex &gt;= n) {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                        printf(<span class="stringliteral">&quot;ATTENTION!\n&quot;</span>);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                    }</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="namespacecxxopts.html#a6d7d82764847cde60d24c9077234adef">patch</a> = <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * m; <span class="comment">//8*n</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                    <span class="keywordflow">while</span> (childIndex &gt;= 0 &amp;&amp; childIndex &lt; n) { <span class="comment">// was n</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                        <span class="comment">//create a new cell (by atomically requesting the next unused array index)</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                        <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> cell = atomicAdd(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;index, 1);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                        <a class="code hl_variable" href="namespacecxxopts.html#a6d7d82764847cde60d24c9077234adef">patch</a> = <a class="code hl_function" href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">min</a>(<a class="code hl_variable" href="namespacecxxopts.html#a6d7d82764847cde60d24c9077234adef">patch</a>, cell);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span> </div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespacecxxopts.html#a6d7d82764847cde60d24c9077234adef">patch</a> != cell) {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                            <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * temp + childPath] = cell;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                        }</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                        level++;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                        <span class="comment">// ATTENTION: most likely a problem with level counting (level = level - 1)</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                        <span class="comment">// but could be also a problem regarding maximum tree depth...</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                        <span class="keywordflow">if</span> (level &gt; (<a class="code hl_define" href="parameter_8h.html#a5bb4257ca9fa4bfcf9391b7895b97761">MAX_LEVEL</a> + 1)) {</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span><span class="preprocessor">#if DIM == 1</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                            <a class="code hl_define" href="cuda__utilities_8cuh.html#a18f09c8175084d073dc810de445cdf3e">cudaAssert</a>(<span class="stringliteral">&quot;buildTree: level = %i for index %i (%e)&quot;</span>, level,</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                                       bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span><span class="preprocessor">#elif DIM == 2</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>                            <a class="code hl_define" href="cuda__utilities_8cuh.html#a18f09c8175084d073dc810de445cdf3e">cudaAssert</a>(<span class="stringliteral">&quot;buildTree: level = %i for index %i (%e, %e)&quot;</span>, level,</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>                                       bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>],</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                                       particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>                            <a class="code hl_define" href="cuda__utilities_8cuh.html#a18f09c8175084d073dc810de445cdf3e">cudaAssert</a>(<span class="stringliteral">&quot;buildTree: level = %i for index %i (%e, %e, %e)&quot;</span>, level,</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>                                       bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>],</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>                                       particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>],</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                                       particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                        }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                        <span class="comment">// insert old/original particle</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                        childPath = 0;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[childIndex] &lt; 0.5 * (min_x + max_x)) { childPath += 1; }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>                        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[childIndex] &lt; 0.5 * (min_y + max_y)) { childPath += 2; }</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[childIndex] &lt; 0.5 * (min_z + max_z)) { childPath += 4; }</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="preprocessor">#if COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[cell] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(childIndex, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4">Entry::x</a>);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>                        <span class="comment">//particles-&gt;x[cell] += particles-&gt;weightedEntry(childIndex, Entry::x);</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[cell] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(childIndex, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b">Entry::y</a>);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>                        <span class="comment">//particles-&gt;y[cell] += particles-&gt;weightedEntry(childIndex, Entry::y);</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[cell] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(childIndex, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26">Entry::z</a>);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>                        <span class="comment">//particles-&gt;z[cell] += particles-&gt;weightedEntry(childIndex, Entry::z);</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                        <span class="comment">//if (cell % 1000 == 0) {</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                        <span class="comment">//    printf(&quot;buildTree: x[%i] = (%f, %f, %f) from x[%i] = (%f, %f, %f) m = %f\n&quot;, cell, particles-&gt;x[cell], particles-&gt;y[cell],</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                        <span class="comment">//           particles-&gt;z[cell], childIndex, particles-&gt;x[childIndex], particles-&gt;y[childIndex],</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                        <span class="comment">//           particles-&gt;z[childIndex], particles-&gt;mass[childIndex]);</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                        <span class="comment">//}</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[cell] += particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[childIndex];</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span><span class="preprocessor">#else </span><span class="comment">// COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                        <span class="comment">//particles-&gt;x[cell] = particles-&gt;x[childIndex];</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[cell] = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>                        <span class="comment">//particles-&gt;y[cell] = particles-&gt;y[childIndex];</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[cell] = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                        <span class="comment">//particles-&gt;z[cell] = particles-&gt;z[childIndex];</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[cell] = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="preprocessor">#endif </span><span class="comment">// COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                        <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[cell] += <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[childIndex];</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                        <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * cell + childPath] = childIndex;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[cell] = level;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                        particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[childIndex] += 1;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>                        <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;start[cell] = -1;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span><span class="preprocessor">#if DEBUGGING</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>                        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[cell] &gt;= particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[childIndex]) {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>                            <a class="code hl_define" href="cuda__utilities_8cuh.html#a18f09c8175084d073dc810de445cdf3e">cudaAssert</a>(<span class="stringliteral">&quot;lvl: %i vs. %i\n&quot;</span>, particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[cell], particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[childIndex]);</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                        }</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                        <span class="comment">// insert new particle</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                        temp = cell;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>                        childPath = 0;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span> </div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>                        <span class="comment">// find insertion point for body</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>                        <span class="comment">//if (particles-&gt;x[bodyIndex + offset] &lt; 0.5 * (min_x + max_x)) {</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>                        <span class="keywordflow">if</span> (x &lt; 0.5 * (min_x + max_x)) {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>                            childPath += 1;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                            max_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>                            min_x = 0.5 * (min_x + max_x);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>                        }</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                        <span class="comment">//if (particles-&gt;y[bodyIndex + offset] &lt; 0.5 * (min_y + max_y)) {</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>                        <span class="keywordflow">if</span> (y &lt; 0.5 * (min_y + max_y)) {</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>                            childPath += 2;</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>                            max_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                            min_y = 0.5 * (min_y + max_y);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                        }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                        <span class="comment">//if (particles-&gt;z[bodyIndex + offset] &lt; 0.5 * (min_z + max_z)) {</span></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                        <span class="keywordflow">if</span> (z &lt; 0.5 * (min_z + max_z)) {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                            childPath += 4;</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                            max_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>                            min_z = 0.5 * (min_z + max_z);</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>                        }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span><span class="preprocessor">#if COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>                        <span class="comment">// COM / preparing for calculation of COM</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>                        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] != 0) {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>                            <span class="comment">//particles-&gt;x[cell] += particles-&gt;weightedEntry(bodyIndex + offset, Entry::x);</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>                            particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[cell] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4">Entry::x</a>);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>                            <span class="comment">//particles-&gt;y[cell] += particles-&gt;weightedEntry(bodyIndex + offset, Entry::y);</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                            particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[cell] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b">Entry::y</a>);</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>                            <span class="comment">//particles-&gt;z[cell] += particles-&gt;weightedEntry(bodyIndex + offset, Entry::z);</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>                            particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[cell] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26">Entry::z</a>);</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>                            particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[cell] += particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                        }</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="preprocessor">#endif </span><span class="comment">// COMPUTE_DIRECTLY</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>                        <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[cell] += <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>                        childIndex = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * temp + childPath];</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>                    }</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span> </div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>                    <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * temp + childPath] = bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>                    particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] = level + 1;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span> </div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>                    __threadfence();  <span class="comment">// written to global memory arrays (child, x, y, mass) thus need to fence</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>                    <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[locked] = <a class="code hl_variable" href="namespacecxxopts.html#a6d7d82764847cde60d24c9077234adef">patch</a>;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>                }</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>                <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>                newBody = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            }</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>        }</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>        __syncthreads();</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    }</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>}</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span> </div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a03421625b4c2426ab14034cb28770a30">  766</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a03421625b4c2426ab14034cb28770a30">TreeNS::Kernel::prepareSorting</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="keywordtype">int</span> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="keywordtype">int</span> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="keywordflow">while</span> ((bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>) &lt; n) {</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;start[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] = bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>;</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>        <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    }</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>}</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a50f06453b04e9617be21fcdbaafad2f4">  778</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a50f06453b04e9617be21fcdbaafad2f4">TreeNS::Kernel::calculateCentersOfMass</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> level) {</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    <span class="keywordtype">int</span> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    <span class="keywordtype">int</span> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span> </div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = n;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    <span class="keyword">register</span> <span class="keywordtype">int</span> i, index;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    <span class="keyword">register</span> <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> mass;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>    <span class="keyword">register</span> <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> x;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    <span class="keyword">register</span> <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> y;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <span class="keyword">register</span> <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    <span class="keywordflow">while</span> ((bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>) &lt; *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;index) {</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>        i = bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[i] == level) {</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>            <span class="comment">//if (particles-&gt;level[bodyIndex + offset] == -1 || particles-&gt;level[bodyIndex + offset] &gt; 21) {</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>            <span class="comment">//    printf(&quot;level[%i] = %i!!!\n&quot;, bodyIndex + offset, particles-&gt;level[bodyIndex + offset]);</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>            <span class="comment">//    //assert(0);</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span> </div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            <span class="comment">// reset entries</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>            mass = 0.; <span class="comment">//particles-&gt;mass[i] = 0.;</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>            x = 0.; <span class="comment">//particles-&gt;x[i] = 0.;</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            y = 0.; <span class="comment">//particles-&gt;y[i] = 0.;</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            z = 0.; <span class="comment">//particles-&gt;z[i] = 0.;</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>            <span class="comment">// loop over children and add contribution (*=position(child) * mass(child))</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span><span class="preprocessor">            #pragma unroll</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> child = 0; child &lt; <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; ++child) {</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>                index = <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * i + child;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[index] != -1) {</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>                    x += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[index], <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4">Entry::x</a>);</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>                    y += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[index], <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b">Entry::y</a>);</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>                    z += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[index], <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26">Entry::z</a>);</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>                    mass += particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[index]];</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>                }</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            }</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span> </div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>            <span class="comment">// finish center of mass calculation by dividing with mass</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>            <span class="keywordflow">if</span> (mass &gt; 0.) { <span class="comment">//particles-&gt;mass[i]</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>                <span class="comment">//particles-&gt;x[i] /= particles-&gt;mass[i];</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>                x /= mass;</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>                <span class="comment">//particles-&gt;y[i] /= particles-&gt;mass[i];</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>                y /= mass;</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>                <span class="comment">//particles-&gt;z[i] /= particles-&gt;mass[i];</span></div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>                z /= mass;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>            }</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[i] = mass;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[i] = x;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[i] = y;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[i] = z;</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span> </div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        }</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>        <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    }</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span> </div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>}</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span> </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span><span class="comment">// TODO: not needed anymore and ATTENTION! requires preparation within buildTree (using atomicAdd)</span></div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span><span class="comment">//  therefore moved to calculateCenterOfMass(), since atomicOperations for 64-bit values VERY expensive</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#ac9fa3124b25c27e31f9bc642f6682c9a">  863</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#ac9fa3124b25c27e31f9bc642f6682c9a">TreeNS::Kernel::centerOfMass</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n) {</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span> </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x*blockDim.x;</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x*gridDim.x;</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span> </div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    <span class="comment">//note: most of it already done within buildTreeKernel</span></div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    bodyIndex += n;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> </div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="keywordflow">while</span> (bodyIndex + offset &lt; *tree-&gt;index) {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span> </div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] != 0) {</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] /= particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] /= particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>            particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] /= particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        }</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>    }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>}</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span><span class="comment">// TODO: not working properly right now (only working for small number of particles)</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a62546cdc289cf7e550229f1bc0fcd710">  889</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a62546cdc289cf7e550229f1bc0fcd710">TreeNS::Kernel::sort</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span> </div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span> </div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> s = 0;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <span class="keywordflow">if</span> (threadIdx.x == 0) {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span> </div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++){</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> node = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[i];</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>            <span class="keywordflow">if</span> (node &gt;= m) { <span class="comment">//n // not a leaf node</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>                <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;start[node] = s;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>                s += <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[node];</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            }</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node &gt;= 0) { <span class="comment">// leaf node</span></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>                <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;sorted[s] = node;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>                s++;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            }</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        }</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    }</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> cell = m + bodyIndex;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> ind = *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;index;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    <span class="comment">//integer ind = tree-&gt;toDeleteNode[1];</span></div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    <span class="keywordflow">while</span> ((cell + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>) &lt; ind) {</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        s = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;start[cell + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span> </div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        <span class="keywordflow">if</span> (s &gt;= 0) {</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span> </div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++) {</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>                <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> node = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>*(cell+<a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>) + i];</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>                <span class="keywordflow">if</span> (node &gt;= m) { <span class="comment">//m // not a leaf node</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>                    <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;start[node] = s;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>                    s += <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;count[node];</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>                }</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (node &gt;= 0) { <span class="comment">// leaf node</span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>                    <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;sorted[s] = node;</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                    s++;</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>                }</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            }</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>        }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>    }</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>}</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a0fad98f746cd35ab1326b890f9fc6911">  936</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a0fad98f746cd35ab1326b890f9fc6911">TreeNS::Kernel::getParticleKeys</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> *keys, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> maxLevel,</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>                                <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_enumeration" href="struct_curve.html#a4269858acf8d67e3cd222466771848b9">Curve::Type</a> curveType) {</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span> </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>    <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span> </div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>    <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> particleKey;</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> </div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    <span class="keywordflow">while</span> (bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> &lt; n) {</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span> </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        particleKey = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;getParticleKey(particles, bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, maxLevel, curveType);</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span><span class="preprocessor">#if DEBUGGING</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <span class="keywordflow">if</span> (particleKey == 1UL) {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>            printf(<span class="stringliteral">&quot;particleKey = %lu (%f, %f, %f)\n&quot;</span>, particleKey, particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>],</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>                   particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>], particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]);</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        }</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        keys[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] = particleKey;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    }</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>}</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#ac12b396be097c1ba6b2d40ee13c8aefe">  963</a></span>__global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#ac12b396be097c1ba6b2d40ee13c8aefe">TreeNS::Kernel::globalCOM</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> com[<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>]) {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> mass = 0;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>; i++) {</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>        com[i] = 0;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    }</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++) {</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[i] != -1) {</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>            mass += particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[i]];</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>            com[0] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[i], <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4">Entry::x</a>);</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>            com[1] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[i], <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b">Entry::y</a>);</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>            com[2] += particles-&gt;<a class="code hl_function" href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">weightedEntry</a>(<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[i], <a class="code hl_enumvalue" href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26">Entry::z</a>);</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        }</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    }</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    <span class="keywordflow">if</span> (mass &gt; 0) {</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>        com[0] /= mass;</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>        com[1] /= mass;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        com[2] /= mass;</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    }</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span> </div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>}</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_tree_n_s.html">TreeNS</a> {</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span> </div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    <span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_kernel.html">Kernel</a> {</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span> </div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a03856aa26ee3ae76c862b3a40716efc6">  997</a></span>        __global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a03856aa26ee3ae76c862b3a40716efc6">set</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>                                  <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>            <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;set(count, start, child, sorted, index, toDeleteLeaf, toDeleteNode, minX, maxX);</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>        }</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span> </div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a0ac4a07f399ad9c0105da9d1466b464a"> 1002</a></span>        __global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a0ac4a07f399ad9c0105da9d1466b464a">info</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span> </div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>            <span class="keywordtype">int</span> relevantChild = 0;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            <span class="keywordtype">int</span> childIndex, temp;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>            <span class="keywordflow">while</span> ((bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>) &lt; <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>) {</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>                childIndex = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>];</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>                temp = childIndex;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>                <span class="keywordflow">while</span> (childIndex != -1) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>                    childIndex = <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * childIndex + relevantChild];</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span> </div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                    <span class="keywordflow">if</span> (childIndex != -1) {</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                        <span class="keywordflow">if</span> (particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[temp] &gt;= particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[childIndex]) {</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>                            <a class="code hl_define" href="cuda__utilities_8cuh.html#a18f09c8175084d073dc810de445cdf3e">cudaAssert</a>(<span class="stringliteral">&quot;level[%i]: %i vs. level[%i]: %i\n&quot;</span>, temp, particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[temp], childIndex,</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>                                       particles-&gt;<a class="code hl_variable" href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">level</a>[childIndex]);</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>                        }</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>                    }</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span> </div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>                    temp = childIndex;</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>                }</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> </div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>                <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>            }</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span> </div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>            <span class="comment">//while ((bodyIndex + offset) &lt; n) {</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>            <span class="comment">//    if (particles-&gt;level[bodyIndex + offset] &lt; 0) {</span></div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>            <span class="comment">//        printf(&quot;attention: level[%i] = %i\n&quot;, bodyIndex + offset,</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>            <span class="comment">//               particles-&gt;level[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>            <span class="comment">//        assert(0);</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>            <span class="comment">//offset = m;</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>            <span class="comment">//while ((bodyIndex + offset) &lt; *tree-&gt;index) {</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>            <span class="comment">//    if (particles-&gt;level[bodyIndex + offset] &lt; 0 &amp;&amp; particles-&gt;mass[bodyIndex + offset] &gt; 1e-4) {</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>            <span class="comment">//#if DIM == 3</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>            <span class="comment">//        printf(&quot;attention: level[%i] = %i (%e, %e, %e) %e\n&quot;, bodyIndex + offset,</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>            <span class="comment">//               particles-&gt;level[bodyIndex + offset],</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>            <span class="comment">//               particles-&gt;x[bodyIndex + offset],</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>            <span class="comment">//               particles-&gt;y[bodyIndex + offset],</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>            <span class="comment">//               particles-&gt;z[bodyIndex + offset],</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>            <span class="comment">//               particles-&gt;mass[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>            <span class="comment">//#endif</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>            <span class="comment">//        assert(0);</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>            <span class="comment">//offset = tree-&gt;toDeleteLeaf[0];</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>            <span class="comment">//while ((bodyIndex + offset) &lt; n &amp;&amp; (bodyIndex + offset)) {</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>            <span class="comment">//    for (int i=0; i&lt;POW_DIM; i++) {</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>            <span class="comment">//        if (tree-&gt;child[POW_DIM * (bodyIndex + offset) + i] != -1) {</span></div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>            <span class="comment">//            printf(&quot;tree-&gt;child[POW_DIM * %i + %i] = %i\n&quot;, bodyIndex + offset, i, tree-&gt;child[POW_DIM * (bodyIndex + offset) + i]);</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>            <span class="comment">//            assert(0);</span></div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>            <span class="comment">//        }</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>            <span class="comment">//offset = tree-&gt;toDeleteNode[0];</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>            <span class="comment">//while ((bodyIndex + offset) &lt; m &amp;&amp; (bodyIndex + offset)) {</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>            <span class="comment">//    for (int i=0; i&lt;POW_DIM; i++) {</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>            <span class="comment">//        if (tree-&gt;child[POW_DIM * (bodyIndex + offset) + i] != -1) {</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>            <span class="comment">//            printf(&quot;tree-&gt;child[POW_DIM * %i + %i] = %i\n&quot;, bodyIndex + offset, i, tree-&gt;child[POW_DIM * (bodyIndex + offset) + i]);</span></div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>            <span class="comment">//            assert(0);</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>            <span class="comment">//        }</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span> </div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>            <span class="comment">//while (bodyIndex + offset &lt; n) {</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>            <span class="comment">//    if ((bodyIndex + offset) % 10000 == 0) {</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>            <span class="comment">//        printf(&quot;tree info\n&quot;);</span></div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span> </div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>            <span class="comment">//bodyIndex += n;</span></div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>            <span class="comment">//while (bodyIndex + offset &lt; m) {</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>                <span class="comment">//printf(&quot;particles-&gt;mass[%i] = %f (%f, %f, %f) (%i, %i)\n&quot;, bodyIndex + offset,</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>                <span class="comment">//       particles-&gt;mass[bodyIndex + offset],</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>                <span class="comment">//       particles-&gt;x[bodyIndex + offset],</span></div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>                <span class="comment">//       particles-&gt;y[bodyIndex + offset],</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>                <span class="comment">//       particles-&gt;z[bodyIndex + offset], n, m);</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span> </div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>                <span class="comment">//printf(&quot;x[%i] = (%f, %f, %f) mass = %f\n&quot;, bodyIndex + offset, particles-&gt;x[bodyIndex + offset],</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>                <span class="comment">//       particles-&gt;y[bodyIndex + offset], particles-&gt;z[bodyIndex + offset],</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>                <span class="comment">//       particles-&gt;mass[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>                <span class="comment">//#if DIM == 1</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>                <span class="comment">//printf(&quot;(%f), \n&quot;, particles-&gt;x[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>                <span class="comment">//#elif DIM == 2</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>                <span class="comment">//printf(&quot;(%f, %f), \n&quot;, particles-&gt;x[bodyIndex + offset],</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>                <span class="comment">//       particles-&gt;y[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>                <span class="comment">//#else</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>                <span class="comment">//printf(&quot;(%f, %f, %f), \n&quot;, particles-&gt;x[bodyIndex + offset],</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>                <span class="comment">//               particles-&gt;y[bodyIndex + offset], particles-&gt;z[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>                <span class="comment">//#endif</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>                <span class="comment">//offset += stride;</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>        }</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span> </div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a6c0d1d2971ebac99b606fb8b6d3f543b"> 1106</a></span>        __global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a0ac4a07f399ad9c0105da9d1466b464a">info</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles) {</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span> </div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span> </div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>            <span class="keywordflow">while</span> (bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> &lt; <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>) {</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>                printf(<span class="stringliteral">&quot;child[POW_DIM * 0 + %i] = %i, x = (%f, %f, %f) m = %f\n&quot;</span>, bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>,</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>                       <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>], particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]],</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>                       particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]], particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]],</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>                       particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]]);</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++) {</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>                    printf(<span class="stringliteral">&quot;child[POW_DIM * %i + %i] = %i, x = (%f, %f, %f) m = %f\n&quot;</span>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>], i,</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>                           <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i],</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>                           particles-&gt;<a class="code hl_variable" href="class_particles.html#a122a9985fed39c45d3a151dba2794299">x</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i]],</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>                           particles-&gt;<a class="code hl_variable" href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">y</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i]],</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>                           particles-&gt;<a class="code hl_variable" href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">z</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i]],</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                           particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i]]);</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>                }</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>                <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>            }</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>        }</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span> </div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a065298c80be1e57e7062b6421e606562"> 1133</a></span>        __global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a065298c80be1e57e7062b6421e606562">testTree</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> bodyIndex = threadIdx.x + blockIdx.x * blockDim.x;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> stride = blockDim.x * gridDim.x;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>            <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> = 0;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> mass;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> masses[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>];</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span> </div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>            <span class="keywordflow">while</span> (bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> &lt; <a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>) {</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span> </div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>                mass = 0;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a>; i++) {</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>                    masses[i] = 0;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i] != -1) {</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>                        masses[i] = particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[<a class="code hl_define" href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a> * <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>] + i]];</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>                        mass += masses[i];</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>                    }</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>                }</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>                <span class="keywordflow">if</span> (mass != particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]]) {</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>                    printf(<span class="stringliteral">&quot;testTree: index: %i mass %f vs %f (%f, %f, %f, %f, %f, %f, %f, %f)\n&quot;</span>, bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>, mass, particles-&gt;<a class="code hl_variable" href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">mass</a>[<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;child[bodyIndex + <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a>]],</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>                           masses[0], masses[1], masses[2], masses[3], masses[4], masses[5], masses[6], masses[7]);</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>                }</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>                <a class="code hl_variable" href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a> += stride;</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>            }</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span> </div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>            <span class="comment">//while (bodyIndex + offset &lt; n) {</span></div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>            <span class="comment">//    if (particles-&gt;x[bodyIndex + offset] == 0.f &amp;&amp;</span></div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>            <span class="comment">//        particles-&gt;y[bodyIndex + offset] == 0.f &amp;&amp;</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>            <span class="comment">//        particles-&gt;z[bodyIndex + offset] == 0.f &amp;&amp;</span></div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>            <span class="comment">//        particles-&gt;mass[bodyIndex + offset] == 0.f) {</span></div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>            <span class="comment">//        printf(&quot;particle ZERO for index = %i: (%f, %f, %f) %f\n&quot;, bodyIndex + offset,</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>            <span class="comment">//               particles-&gt;x[bodyIndex + offset], particles-&gt;y[bodyIndex + offset],</span></div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>            <span class="comment">//               particles-&gt;z[bodyIndex + offset], particles-&gt;mass[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>            <span class="comment">//</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>            <span class="comment">//offset = m;</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>            <span class="comment">//while (bodyIndex + offset &lt; *tree-&gt;index) {</span></div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>            <span class="comment">//    if (particles-&gt;x[bodyIndex + offset] == 0.f &amp;&amp;</span></div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>            <span class="comment">//        particles-&gt;y[bodyIndex + offset] == 0.f &amp;&amp;</span></div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>            <span class="comment">//        particles-&gt;z[bodyIndex + offset] == 0.f &amp;&amp;</span></div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>            <span class="comment">//        particles-&gt;mass[bodyIndex + offset] == 0.f) {</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>            <span class="comment">//        printf(&quot;particle ZERO for index = %i: (%f, %f, %f) %f\n&quot;, bodyIndex + offset,</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>            <span class="comment">//               particles-&gt;x[bodyIndex + offset], particles-&gt;y[bodyIndex + offset],</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>            <span class="comment">//               particles-&gt;z[bodyIndex + offset], particles-&gt;mass[bodyIndex + offset]);</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>            <span class="comment">//    }</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>            <span class="comment">//    offset += stride;</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>        }</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span> </div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb753dc3f8f9c76c94d3d2a08c5d4ab6"> 1187</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb753dc3f8f9c76c94d3d2a08c5d4ab6">Launch::set</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>                             <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode , <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX) {</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>            <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy(1, 1);</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>            <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">false</span>, executionPolicy, <a class="code hl_function" href="namespacecuda.html#a96edb690f1eb4317fc5a936169735bfc">::TreeNS::Kernel::set</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, count, start, child, sorted,</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>                         index, toDeleteLeaf, toDeleteNode, minX, maxX);</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        }</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span> </div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ade411a924c060711cf890d8343ad386c"> 1194</a></span>        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ade411a924c060711cf890d8343ad386c">Launch::info</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>            <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">true</span>, executionPolicy, <a class="code hl_function" href="namespace_material_n_s_1_1_kernel.html#a11f3c84e75bfefabb878a6184fc3b2c8">::TreeNS::Kernel::info</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, n, m);</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        }</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span> </div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#afab3bfb965234b9b8df728a0005bf3d0"> 1199</a></span>        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ade411a924c060711cf890d8343ad386c">Launch::info</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles) {</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">true</span>, executionPolicy, <a class="code hl_function" href="namespace_material_n_s_1_1_kernel.html#a11f3c84e75bfefabb878a6184fc3b2c8">::TreeNS::Kernel::info</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>        }</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span> </div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ab754af60f9812e8fe12f2554800d0f46"> 1204</a></span>        <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ab754af60f9812e8fe12f2554800d0f46">Launch::testTree</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>            <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">true</span>, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a065298c80be1e57e7062b6421e606562">::TreeNS::Kernel::testTree</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, n, m);</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>        }</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span><span class="preprocessor">#if DIM &gt; 1</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a11cbea1199c8279faad9d3a5b46c42f9"> 1211</a></span>        __global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a03856aa26ee3ae76c862b3a40716efc6">set</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>                                  <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX,</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>                                  <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY) {</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>            <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;set(count, start, child, sorted, index, toDeleteLeaf, toDeleteNode, minX, maxX, minY, maxY);</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        }</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span> </div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a38ff3ed2dc7b1abf31e292dbb6a41326"> 1217</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb753dc3f8f9c76c94d3d2a08c5d4ab6">Launch::set</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>                             <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX,</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>                             <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY) {</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>            <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy(1, 1);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>            <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">false</span>, executionPolicy, <a class="code hl_function" href="namespacecuda.html#a96edb690f1eb4317fc5a936169735bfc">::TreeNS::Kernel::set</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, count, start, child, sorted, index,</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>                         toDeleteLeaf, toDeleteNode, minX, maxX, minY, maxY);</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>        }</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span> </div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span><span class="preprocessor">#if DIM == 3</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel.html#a60157d90e3b4450b73c6a70eb066e917"> 1227</a></span>        __global__ <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a03856aa26ee3ae76c862b3a40716efc6">set</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>                                  <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX,</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>                                  <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minZ, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxZ) {</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>            <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>-&gt;set(count, start, child, sorted, index, toDeleteLeaf, toDeleteNode, minX, maxX, minY, maxY,</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>                      minZ, maxZ);</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>        }</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a01af672ac88fa9ef5b8ccf99c5f07c8e"> 1234</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb753dc3f8f9c76c94d3d2a08c5d4ab6">Launch::set</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *count, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *start, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *child, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *sorted,</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>                             <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *index, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteLeaf, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *toDeleteNode, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minX, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxX,</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>                             <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxY, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *minZ, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *maxZ) {</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>            <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy(1, 1);</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>            <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">false</span>, executionPolicy, <a class="code hl_function" href="namespacecuda.html#a96edb690f1eb4317fc5a936169735bfc">::TreeNS::Kernel::set</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, count, start, child, sorted, index,</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>                         toDeleteLeaf, toDeleteNode, minX, maxX, minY, maxY, minZ, maxZ);</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>        }</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span> </div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span> </div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>        <span class="keyword">namespace </span>Launch {</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span> </div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a911b10c538f0cad7e63059b38d6d5010"> 1247</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a911b10c538f0cad7e63059b38d6d5010">sumParticles</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>) {</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">true</span>, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a528859bf46a47a236eb3380e4883b3d9">::TreeNS::Kernel::sumParticles</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>            }</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span> </div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ae88c1aeb2ec83d4918341f94775fd482"> 1252</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ae88c1aeb2ec83d4918341f94775fd482">buildTree</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m, <span class="keywordtype">bool</span> time) {</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#aba9c2fd609640bbaf1833fb6a7a8b4ff">::TreeNS::Kernel::buildTree</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, n, m);</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>            }</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span> </div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a673614fc610388d953a55140a9687fd0"> 1257</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a673614fc610388d953a55140a9687fd0">prepareSorting</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m) {</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a03421625b4c2426ab14034cb28770a30">::TreeNS::Kernel::prepareSorting</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, n, m);</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>            }</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span> </div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a425725288f34fb1f7dba369f4296224c"> 1262</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a425725288f34fb1f7dba369f4296224c">calculateCentersOfMass</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> level, <span class="keywordtype">bool</span> time) {</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_s_p_h_1_1_kernel.html#a20ebf0f22ec1fe57f2c49393e8cb1a55">::TreeNS::Kernel::calculateCentersOfMass</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, n, level);</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>            }</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span> </div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb1fcee1becc94a7cf945401be17109e"> 1267</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb1fcee1becc94a7cf945401be17109e">computeBoundingBox</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> *mutex, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> blockSize,</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>                                    <span class="keywordtype">bool</span> time) {</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>                <span class="keywordtype">size_t</span> sharedMemory = 2 * <a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>) * blockSize;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy(4, 256, sharedMemory);</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a3fc2ba2061d44f078127d7d0461e0bd9">::TreeNS::Kernel::computeBoundingBox</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, mutex,</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>                                    n, blockSize);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            }</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a8ddd7c01bdb19a1b91ba8a960e1567f9"> 1275</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a8ddd7c01bdb19a1b91ba8a960e1567f9">centerOfMass</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <span class="keywordtype">bool</span> time) {</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#ac9fa3124b25c27e31f9bc642f6682c9a">::TreeNS::Kernel::centerOfMass</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, n);</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>            }</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span> </div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a7497c964666b61f561f290420ea52951"> 1280</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a7497c964666b61f561f290420ea52951">sort</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> m, <span class="keywordtype">bool</span> time) {</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#a62546cdc289cf7e550229f1bc0fcd710">::TreeNS::Kernel::sort</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, n, m);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>            }</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span> </div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ad70cfcabd69d27961e28afbadeebee64"> 1285</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ad70cfcabd69d27961e28afbadeebee64">getParticleKeys</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a> *keys, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> maxLevel, <a class="code hl_typedef" href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a> n,</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>                                 <a class="code hl_enumeration" href="struct_curve.html#a4269858acf8d67e3cd222466771848b9">Curve::Type</a> curveType, <span class="keywordtype">bool</span> time) {</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy;</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(time, executionPolicy, <a class="code hl_function" href="namespace_sub_domain_key_tree_n_s_1_1_kernel.html#a2729bc71e6579423cf48f5476ee7cffc">::TreeNS::Kernel::getParticleKeys</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, keys,</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>                                    maxLevel, n, curveType);</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>            }</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span> </div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"><a class="line" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#aa1ce5fbc0e93e4164805624f892c2cc3"> 1292</a></span>            <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#aa1ce5fbc0e93e4164805624f892c2cc3">globalCOM</a>(<a class="code hl_class" href="class_tree.html">Tree</a> *<a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, <a class="code hl_class" href="class_particles.html">Particles</a> *particles, <a class="code hl_typedef" href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> com[<a class="code hl_define" href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>]) {</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>                <a class="code hl_class" href="class_execution_policy.html">ExecutionPolicy</a> executionPolicy(1, 1);</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a>(<span class="keyword">true</span>, executionPolicy, <a class="code hl_function" href="namespace_tree_n_s_1_1_kernel.html#ac12b396be097c1ba6b2d40ee13c8aefe">::TreeNS::Kernel::globalCOM</a>, <a class="code hl_variable" href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">tree</a>, particles, com);</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>            }</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>        }</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>    }</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>}</div>
<div class="ttc" id="aclass_execution_policy_html"><div class="ttname"><a href="class_execution_policy.html">ExecutionPolicy</a></div><div class="ttdef"><b>Definition:</b> <a href="cuda__launcher_8cuh_source.html#l00013">cuda_launcher.cuh:13</a></div></div>
<div class="ttc" id="aclass_particles_html"><div class="ttname"><a href="class_particles.html">Particles</a></div><div class="ttdef"><b>Definition:</b> <a href="particles_8cuh_source.html#l00013">particles.cuh:13</a></div></div>
<div class="ttc" id="aclass_particles_html_a0ea028b81c33a114234c44ff82118f64"><div class="ttname"><a href="class_particles.html#a0ea028b81c33a114234c44ff82118f64">Particles::weightedEntry</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER real weightedEntry(integer index, Entry::Name entry)</div><div class="ttdef"><b>Definition:</b> <a href="particles_8cu_source.html#l00307">particles.cu:307</a></div></div>
<div class="ttc" id="aclass_particles_html_a122a9985fed39c45d3a151dba2794299"><div class="ttname"><a href="class_particles.html#a122a9985fed39c45d3a151dba2794299">Particles::x</a></div><div class="ttdeci">real * x</div><div class="ttdoc">(pointer to) x position (array)</div><div class="ttdef"><b>Definition:</b> <a href="particles_8cuh_source.html#l00023">particles.cuh:23</a></div></div>
<div class="ttc" id="aclass_particles_html_a19adbbf68f6c36892dee44dd76a2b0d3"><div class="ttname"><a href="class_particles.html#a19adbbf68f6c36892dee44dd76a2b0d3">Particles::level</a></div><div class="ttdeci">integer * level</div><div class="ttdef"><b>Definition:</b> <a href="particles_8cuh_source.html#l00057">particles.cuh:57</a></div></div>
<div class="ttc" id="aclass_particles_html_a745f3d6ed2124a0c2edb724231d555eb"><div class="ttname"><a href="class_particles.html#a745f3d6ed2124a0c2edb724231d555eb">Particles::y</a></div><div class="ttdeci">real * y</div><div class="ttdoc">(pointer to) y position (array)</div><div class="ttdef"><b>Definition:</b> <a href="particles_8cuh_source.html#l00030">particles.cuh:30</a></div></div>
<div class="ttc" id="aclass_particles_html_ab65623c55daecdf520fe921621d57bf2"><div class="ttname"><a href="class_particles.html#ab65623c55daecdf520fe921621d57bf2">Particles::mass</a></div><div class="ttdeci">real * mass</div><div class="ttdoc">(pointer to) mass (array)</div><div class="ttdef"><b>Definition:</b> <a href="particles_8cuh_source.html#l00021">particles.cuh:21</a></div></div>
<div class="ttc" id="aclass_particles_html_abff3b199228c5f95c78d5e23ad64d2b3"><div class="ttname"><a href="class_particles.html#abff3b199228c5f95c78d5e23ad64d2b3">Particles::z</a></div><div class="ttdeci">real * z</div><div class="ttdoc">(pointer to) z position (array)</div><div class="ttdef"><b>Definition:</b> <a href="particles_8cuh_source.html#l00037">particles.cuh:37</a></div></div>
<div class="ttc" id="aclass_tree_html"><div class="ttname"><a href="class_tree.html">Tree</a></div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00121">tree.cuh:121</a></div></div>
<div class="ttc" id="aclass_tree_html_a134f2cb7fb4402ff7e84e272fe85dccd"><div class="ttname"><a href="class_tree.html#a134f2cb7fb4402ff7e84e272fe85dccd">Tree::reset</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER void reset(integer index, integer n)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00133">tree.cu:133</a></div></div>
<div class="ttc" id="aclass_tree_html_a142119232057402f36976ea7b4870b9e"><div class="ttname"><a href="class_tree.html#a142119232057402f36976ea7b4870b9e">Tree::index</a></div><div class="ttdeci">integer * index</div><div class="ttdoc">index used for counting nodes</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00135">tree.cuh:135</a></div></div>
<div class="ttc" id="aclass_tree_html_a27424a8982b78a175d450e507226e19b"><div class="ttname"><a href="class_tree.html#a27424a8982b78a175d450e507226e19b">Tree::minZ</a></div><div class="ttdeci">real * minZ</div><div class="ttdoc">bounding box minimal z</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00153">tree.cuh:153</a></div></div>
<div class="ttc" id="aclass_tree_html_a2d0f77143333d352636ae2a47e64ed1f"><div class="ttname"><a href="class_tree.html#a2d0f77143333d352636ae2a47e64ed1f">Tree::child</a></div><div class="ttdeci">integer * child</div><div class="ttdoc">children/child nodes or leaves (beneath)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00131">tree.cuh:131</a></div></div>
<div class="ttc" id="aclass_tree_html_a3ece229873458b3cdfcebc3e23bb5abd"><div class="ttname"><a href="class_tree.html#a3ece229873458b3cdfcebc3e23bb5abd">Tree::getParticleKey</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER keyType getParticleKey(Particles *particles, integer index, integer maxLevel, Curve::Type curveType=Curve::lebesgue)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00157">tree.cu:157</a></div></div>
<div class="ttc" id="aclass_tree_html_a4b1617063a347bfa32e3b2f51252ffc5"><div class="ttname"><a href="class_tree.html#a4b1617063a347bfa32e3b2f51252ffc5">Tree::maxX</a></div><div class="ttdeci">real * maxX</div><div class="ttdoc">bounding box maximal x</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00145">tree.cuh:145</a></div></div>
<div class="ttc" id="aclass_tree_html_a4fce84d240622d3f8522a94e2f34bfa5"><div class="ttname"><a href="class_tree.html#a4fce84d240622d3f8522a94e2f34bfa5">Tree::sorted</a></div><div class="ttdeci">integer * sorted</div><div class="ttdoc">sorted (indices) for better cache performance</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00133">tree.cuh:133</a></div></div>
<div class="ttc" id="aclass_tree_html_a594ec0555c379f620e2917faeacc45ee"><div class="ttname"><a href="class_tree.html#a594ec0555c379f620e2917faeacc45ee">Tree::count</a></div><div class="ttdeci">integer * count</div><div class="ttdoc">accumulated nodes/leaves beneath</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00127">tree.cuh:127</a></div></div>
<div class="ttc" id="aclass_tree_html_a6c2387d721990c777a77af311ad3209d"><div class="ttname"><a href="class_tree.html#a6c2387d721990c777a77af311ad3209d">Tree::sumParticles</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER integer sumParticles()</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00288">tree.cu:288</a></div></div>
<div class="ttc" id="aclass_tree_html_a6ce0658dd67aa1fee4b20ce7d6594195"><div class="ttname"><a href="class_tree.html#a6ce0658dd67aa1fee4b20ce7d6594195">Tree::toDeleteNode</a></div><div class="ttdeci">integer * toDeleteNode</div><div class="ttdoc">buffer for remembering old indices for rebuilding tree</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00140">tree.cuh:140</a></div></div>
<div class="ttc" id="aclass_tree_html_a7b5f04ad2e40fd4a4411a48316d6a45a"><div class="ttname"><a href="class_tree.html#a7b5f04ad2e40fd4a4411a48316d6a45a">Tree::~Tree</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER ~Tree()</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00298">tree.cu:298</a></div></div>
<div class="ttc" id="aclass_tree_html_a7ce9a900d5e647999b0e3c2d5b566672"><div class="ttname"><a href="class_tree.html#a7ce9a900d5e647999b0e3c2d5b566672">Tree::Tree</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER Tree()</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00055">tree.cu:55</a></div></div>
<div class="ttc" id="aclass_tree_html_ab1b9d3e011a5a8648845a3c1cd3ae4a6"><div class="ttname"><a href="class_tree.html#ab1b9d3e011a5a8648845a3c1cd3ae4a6">Tree::minX</a></div><div class="ttdeci">real * minX</div><div class="ttdoc">bounding box minimal x</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00143">tree.cuh:143</a></div></div>
<div class="ttc" id="aclass_tree_html_ab545804f011618ffa1f64eeecaf9c6fd"><div class="ttname"><a href="class_tree.html#ab545804f011618ffa1f64eeecaf9c6fd">Tree::start</a></div><div class="ttdeci">integer * start</div><div class="ttdoc">TODO: describe start.</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00129">tree.cuh:129</a></div></div>
<div class="ttc" id="aclass_tree_html_ad7860987146e9bd8dfaded17753de0de"><div class="ttname"><a href="class_tree.html#ad7860987146e9bd8dfaded17753de0de">Tree::toDeleteLeaf</a></div><div class="ttdeci">integer * toDeleteLeaf</div><div class="ttdoc">buffer for remembering old indices for rebuilding tree</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00138">tree.cuh:138</a></div></div>
<div class="ttc" id="aclass_tree_html_adaf45c28a56b1cabf9b41a2c27f10200"><div class="ttname"><a href="class_tree.html#adaf45c28a56b1cabf9b41a2c27f10200">Tree::getTreeLevel</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER integer getTreeLevel(Particles *particles, integer index, integer maxLevel, Curve::Type curveType=Curve::lebesgue)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00242">tree.cu:242</a></div></div>
<div class="ttc" id="aclass_tree_html_ae1892b6c0acefa854e967f2db131d5c2"><div class="ttname"><a href="class_tree.html#ae1892b6c0acefa854e967f2db131d5c2">Tree::set</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER void set(integer *count, integer *start, integer *child, integer *sorted, integer *index, integer *toDeleteLeaf, integer *toDeleteNode, real *minX, real *maxX)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00065">tree.cu:65</a></div></div>
<div class="ttc" id="aclass_tree_html_aed457bbacc5a2dfdccd18c2f4deb8f6e"><div class="ttname"><a href="class_tree.html#aed457bbacc5a2dfdccd18c2f4deb8f6e">Tree::maxY</a></div><div class="ttdeci">real * maxY</div><div class="ttdoc">bounding box maximal y</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00150">tree.cuh:150</a></div></div>
<div class="ttc" id="aclass_tree_html_af57a288ef4dfcb575f740937153ad3e4"><div class="ttname"><a href="class_tree.html#af57a288ef4dfcb575f740937153ad3e4">Tree::minY</a></div><div class="ttdeci">real * minY</div><div class="ttdoc">bounding box minimal y</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00148">tree.cuh:148</a></div></div>
<div class="ttc" id="aclass_tree_html_afdff02189752a33f8463f55bf6f58ec0"><div class="ttname"><a href="class_tree.html#afdff02189752a33f8463f55bf6f58ec0">Tree::maxZ</a></div><div class="ttdeci">real * maxZ</div><div class="ttdoc">bounding box maximal z</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00155">tree.cuh:155</a></div></div>
<div class="ttc" id="acuda__utilities_8cuh_html_a18f09c8175084d073dc810de445cdf3e"><div class="ttname"><a href="cuda__utilities_8cuh.html#a18f09c8175084d073dc810de445cdf3e">cudaAssert</a></div><div class="ttdeci">#define cudaAssert(...)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__utilities_8cuh_source.html#l00031">cuda_utilities.cuh:31</a></div></div>
<div class="ttc" id="acuda__utilities_8cuh_html_abaa3393ea5f1f52b7fdfde2beec133b7"><div class="ttname"><a href="cuda__utilities_8cuh.html#abaa3393ea5f1f52b7fdfde2beec133b7">CUDA_CALLABLE_MEMBER</a></div><div class="ttdeci">#define CUDA_CALLABLE_MEMBER</div><div class="ttdef"><b>Definition:</b> <a href="cuda__utilities_8cuh_source.html#l00013">cuda_utilities.cuh:13</a></div></div>
<div class="ttc" id="amap__sph__to__grid_8c_html_af4846c5e98e425a34134b06275f0a109"><div class="ttname"><a href="map__sph__to__grid_8c.html#af4846c5e98e425a34134b06275f0a109">offset</a></div><div class="ttdeci">double offset[DIM]</div><div class="ttdef"><b>Definition:</b> <a href="map__sph__to__grid_8c_source.html#l00066">map_sph_to_grid.c:66</a></div></div>
<div class="ttc" id="anamespace_kernel_html"><div class="ttname"><a href="namespace_kernel.html">Kernel</a></div><div class="ttdef"><b>Definition:</b> <a href="device__rhs_8cuh_source.html#l00007">device_rhs.cuh:7</a></div></div>
<div class="ttc" id="anamespace_key_n_s_html_a25cf68b21e9c4eaebaba93ae8f462433"><div class="ttname"><a href="namespace_key_n_s.html#a25cf68b21e9c4eaebaba93ae8f462433">KeyNS::HilbertTable</a></div><div class="ttdeci">const unsigned char HilbertTable[12][8]</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00075">tree.cuh:75</a></div></div>
<div class="ttc" id="anamespace_key_n_s_html_a7c5eec9fc6ce62a2b5f0f5ecc5c1f38f"><div class="ttname"><a href="namespace_key_n_s.html#a7c5eec9fc6ce62a2b5f0f5ecc5c1f38f">KeyNS::lebesgue2hilbert</a></div><div class="ttdeci">CUDA_CALLABLE_MEMBER keyType lebesgue2hilbert(keyType lebesgue, integer maxLevel)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00004">tree.cu:4</a></div></div>
<div class="ttc" id="anamespace_material_n_s_1_1_kernel_html_a11f3c84e75bfefabb878a6184fc3b2c8"><div class="ttname"><a href="namespace_material_n_s_1_1_kernel.html#a11f3c84e75bfefabb878a6184fc3b2c8">MaterialNS::Kernel::info</a></div><div class="ttdeci">__global__ void info(Material *material)</div><div class="ttdef"><b>Definition:</b> <a href="material_8cu_source.html#l00023">material.cu:23</a></div></div>
<div class="ttc" id="anamespace_profiler_ids_1_1_time_html_a6bc176ffe75049b4b899b6a019bf15e9"><div class="ttname"><a href="namespace_profiler_ids_1_1_time.html#a6bc176ffe75049b4b899b6a019bf15e9">ProfilerIds::Time::tree</a></div><div class="ttdeci">const char *const tree</div><div class="ttdef"><b>Definition:</b> <a href="h5profiler_8h_source.html#l00045">h5profiler.h:45</a></div></div>
<div class="ttc" id="anamespace_s_p_h_1_1_kernel_html_a20ebf0f22ec1fe57f2c49393e8cb1a55"><div class="ttname"><a href="namespace_s_p_h_1_1_kernel.html#a20ebf0f22ec1fe57f2c49393e8cb1a55">SPH::Kernel::calculateCentersOfMass</a></div><div class="ttdeci">__global__ void calculateCentersOfMass(Tree *tree, Particles *particles, integer level)</div><div class="ttdef"><b>Definition:</b> <a href="sph_8cu_source.html#l02248">sph.cu:2248</a></div></div>
<div class="ttc" id="anamespace_sub_domain_key_tree_n_s_1_1_kernel_html_a2729bc71e6579423cf48f5476ee7cffc"><div class="ttname"><a href="namespace_sub_domain_key_tree_n_s_1_1_kernel.html#a2729bc71e6579423cf48f5476ee7cffc">SubDomainKeyTreeNS::Kernel::getParticleKeys</a></div><div class="ttdeci">__global__ void getParticleKeys(SubDomainKeyTree *subDomainKeyTree, Tree *tree, Particles *particles, keyType *keys, integer maxLevel, integer n, Curve::Type curveType=Curve::lebesgue)</div><div class="ttdef"><b>Definition:</b> <a href="subdomain_8cu_source.html#l00602">subdomain.cu:602</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_a425725288f34fb1f7dba369f4296224c"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a425725288f34fb1f7dba369f4296224c">TreeNS::Kernel::Launch::calculateCentersOfMass</a></div><div class="ttdeci">real calculateCentersOfMass(Tree *tree, Particles *particles, integer n, integer level, bool time=false)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01262">tree.cu:1262</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_a673614fc610388d953a55140a9687fd0"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a673614fc610388d953a55140a9687fd0">TreeNS::Kernel::Launch::prepareSorting</a></div><div class="ttdeci">real prepareSorting(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01257">tree.cu:1257</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_a7497c964666b61f561f290420ea52951"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a7497c964666b61f561f290420ea52951">TreeNS::Kernel::Launch::sort</a></div><div class="ttdeci">real sort(Tree *tree, integer n, integer m, bool time=false)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01280">tree.cu:1280</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_a8ddd7c01bdb19a1b91ba8a960e1567f9"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a8ddd7c01bdb19a1b91ba8a960e1567f9">TreeNS::Kernel::Launch::centerOfMass</a></div><div class="ttdeci">real centerOfMass(Tree *tree, Particles *particles, integer n, bool time=false)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01275">tree.cu:1275</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_a911b10c538f0cad7e63059b38d6d5010"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#a911b10c538f0cad7e63059b38d6d5010">TreeNS::Kernel::Launch::sumParticles</a></div><div class="ttdeci">real sumParticles(Tree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01247">tree.cu:1247</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_aa1ce5fbc0e93e4164805624f892c2cc3"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#aa1ce5fbc0e93e4164805624f892c2cc3">TreeNS::Kernel::Launch::globalCOM</a></div><div class="ttdeci">real globalCOM(Tree *tree, Particles *particles, real com[DIM])</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01292">tree.cu:1292</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_ab754af60f9812e8fe12f2554800d0f46"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ab754af60f9812e8fe12f2554800d0f46">TreeNS::Kernel::Launch::testTree</a></div><div class="ttdeci">real testTree(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01204">tree.cu:1204</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_acb1fcee1becc94a7cf945401be17109e"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb1fcee1becc94a7cf945401be17109e">TreeNS::Kernel::Launch::computeBoundingBox</a></div><div class="ttdeci">real computeBoundingBox(Tree *tree, Particles *particles, integer *mutex, integer n, integer blockSize, bool time=false)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01267">tree.cu:1267</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_acb753dc3f8f9c76c94d3d2a08c5d4ab6"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#acb753dc3f8f9c76c94d3d2a08c5d4ab6">TreeNS::Kernel::Launch::set</a></div><div class="ttdeci">void set(Tree *tree, integer *count, integer *start, integer *child, integer *sorted, integer *index, integer *toDeleteLeaf, integer *toDeleteNode, real *minX, real *maxX)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01187">tree.cu:1187</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_ad70cfcabd69d27961e28afbadeebee64"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ad70cfcabd69d27961e28afbadeebee64">TreeNS::Kernel::Launch::getParticleKeys</a></div><div class="ttdeci">real getParticleKeys(Tree *tree, Particles *particles, keyType *keys, integer maxLevel, integer n, Curve::Type curveType=Curve::lebesgue, bool time=false)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01285">tree.cu:1285</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_ade411a924c060711cf890d8343ad386c"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ade411a924c060711cf890d8343ad386c">TreeNS::Kernel::Launch::info</a></div><div class="ttdeci">real info(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01194">tree.cu:1194</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_1_1_launch_html_ae88c1aeb2ec83d4918341f94775fd482"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel_1_1_launch.html#ae88c1aeb2ec83d4918341f94775fd482">TreeNS::Kernel::Launch::buildTree</a></div><div class="ttdeci">real buildTree(Tree *tree, Particles *particles, integer n, integer m, bool time=false)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01252">tree.cu:1252</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a03421625b4c2426ab14034cb28770a30"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a03421625b4c2426ab14034cb28770a30">TreeNS::Kernel::prepareSorting</a></div><div class="ttdeci">__global__ void prepareSorting(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00766">tree.cu:766</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a03856aa26ee3ae76c862b3a40716efc6"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a03856aa26ee3ae76c862b3a40716efc6">TreeNS::Kernel::set</a></div><div class="ttdeci">__global__ void set(Tree *tree, integer *count, integer *start, integer *child, integer *sorted, integer *index, integer *toDeleteLeaf, integer *toDeleteNode, real *minX, real *maxX)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00997">tree.cu:997</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a065298c80be1e57e7062b6421e606562"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a065298c80be1e57e7062b6421e606562">TreeNS::Kernel::testTree</a></div><div class="ttdeci">__global__ void testTree(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01133">tree.cu:1133</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a0ac4a07f399ad9c0105da9d1466b464a"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a0ac4a07f399ad9c0105da9d1466b464a">TreeNS::Kernel::info</a></div><div class="ttdeci">__global__ void info(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l01002">tree.cu:1002</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a0fad98f746cd35ab1326b890f9fc6911"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a0fad98f746cd35ab1326b890f9fc6911">TreeNS::Kernel::getParticleKeys</a></div><div class="ttdeci">__global__ void getParticleKeys(Tree *tree, Particles *particles, keyType *keys, integer maxLevel, integer n, Curve::Type curveType=Curve::lebesgue)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00936">tree.cu:936</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a3fc2ba2061d44f078127d7d0461e0bd9"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a3fc2ba2061d44f078127d7d0461e0bd9">TreeNS::Kernel::computeBoundingBox</a></div><div class="ttdeci">__global__ void computeBoundingBox(Tree *tree, Particles *particles, integer *mutex, integer n, integer blockSize)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00302">tree.cu:302</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a50f06453b04e9617be21fcdbaafad2f4"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a50f06453b04e9617be21fcdbaafad2f4">TreeNS::Kernel::calculateCentersOfMass</a></div><div class="ttdeci">__global__ void calculateCentersOfMass(Tree *tree, Particles *particles, integer n, integer level)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00778">tree.cu:778</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a528859bf46a47a236eb3380e4883b3d9"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a528859bf46a47a236eb3380e4883b3d9">TreeNS::Kernel::sumParticles</a></div><div class="ttdeci">__global__ void sumParticles(Tree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00440">tree.cu:440</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_a62546cdc289cf7e550229f1bc0fcd710"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#a62546cdc289cf7e550229f1bc0fcd710">TreeNS::Kernel::sort</a></div><div class="ttdeci">__global__ void sort(Tree *tree, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00889">tree.cu:889</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_aba9c2fd609640bbaf1833fb6a7a8b4ff"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#aba9c2fd609640bbaf1833fb6a7a8b4ff">TreeNS::Kernel::buildTree</a></div><div class="ttdeci">__global__ void buildTree(Tree *tree, Particles *particles, integer n, integer m)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00454">tree.cu:454</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_ac12b396be097c1ba6b2d40ee13c8aefe"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#ac12b396be097c1ba6b2d40ee13c8aefe">TreeNS::Kernel::globalCOM</a></div><div class="ttdeci">__global__ void globalCOM(Tree *tree, Particles *particles, real com[DIM])</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00963">tree.cu:963</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_1_1_kernel_html_ac9fa3124b25c27e31f9bc642f6682c9a"><div class="ttname"><a href="namespace_tree_n_s_1_1_kernel.html#ac9fa3124b25c27e31f9bc642f6682c9a">TreeNS::Kernel::centerOfMass</a></div><div class="ttdeci">__global__ void centerOfMass(Tree *tree, Particles *particles, integer n)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8cu_source.html#l00863">tree.cu:863</a></div></div>
<div class="ttc" id="anamespace_tree_n_s_html"><div class="ttname"><a href="namespace_tree_n_s.html">TreeNS</a></div><div class="ttdef"><b>Definition:</b> <a href="tree_8cuh_source.html#l00329">tree.cuh:329</a></div></div>
<div class="ttc" id="anamespacecuda_1_1math_html_a129d30e886ca3c7cb2c9b209ce208076"><div class="ttname"><a href="namespacecuda_1_1math.html#a129d30e886ca3c7cb2c9b209ce208076">cuda::math::min</a></div><div class="ttdeci">__device__ real min(real a, real b)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__utilities_8cu_source.html#l00414">cuda_utilities.cu:414</a></div></div>
<div class="ttc" id="anamespacecuda_1_1math_html_ae45b7a0e96687aa98c58a3ee386b2ada"><div class="ttname"><a href="namespacecuda_1_1math.html#ae45b7a0e96687aa98c58a3ee386b2ada">cuda::math::max</a></div><div class="ttdeci">__device__ real max(real a, real b)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__utilities_8cu_source.html#l00431">cuda_utilities.cu:431</a></div></div>
<div class="ttc" id="anamespacecuda_html_a96edb690f1eb4317fc5a936169735bfc"><div class="ttname"><a href="namespacecuda.html#a96edb690f1eb4317fc5a936169735bfc">cuda::set</a></div><div class="ttdeci">void set(T *d_var, T val, std::size_t count=1)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__runtime_8h_source.html#l00026">cuda_runtime.h:26</a></div></div>
<div class="ttc" id="anamespacecuda_html_ae129f267f2d83118533c78c712265b58"><div class="ttname"><a href="namespacecuda.html#ae129f267f2d83118533c78c712265b58">cuda::launch</a></div><div class="ttdeci">real launch(bool timeKernel, const ExecutionPolicy &amp;policy, void(*f)(Arguments...), Arguments... args)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__launcher_8cuh_source.html#l00054">cuda_launcher.cuh:54</a></div></div>
<div class="ttc" id="anamespacecxxopts_html_a6d7d82764847cde60d24c9077234adef"><div class="ttname"><a href="namespacecxxopts.html#a6d7d82764847cde60d24c9077234adef">cxxopts::patch</a></div><div class="ttdeci">uint8_t patch</div><div class="ttdef"><b>Definition:</b> <a href="_h5_renderer_2include_2cxxopts_8h_source.html#l00061">cxxopts.h:61</a></div></div>
<div class="ttc" id="aparameter_8h_html_a11d147c64891830c9e79b3315b1b2e21"><div class="ttname"><a href="parameter_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a></div><div class="ttdeci">double real</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00015">parameter.h:15</a></div></div>
<div class="ttc" id="aparameter_8h_html_a2d83a9d6677f42e2572510c1a14e58ed"><div class="ttname"><a href="parameter_8h.html#a2d83a9d6677f42e2572510c1a14e58ed">keyType</a></div><div class="ttdeci">unsigned long keyType</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00018">parameter.h:18</a></div></div>
<div class="ttc" id="aparameter_8h_html_a3b6ee100a473e8866bcea6d1fc4041d9"><div class="ttname"><a href="parameter_8h.html#a3b6ee100a473e8866bcea6d1fc4041d9">integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00017">parameter.h:17</a></div></div>
<div class="ttc" id="aparameter_8h_html_a5bb4257ca9fa4bfcf9391b7895b97761"><div class="ttname"><a href="parameter_8h.html#a5bb4257ca9fa4bfcf9391b7895b97761">MAX_LEVEL</a></div><div class="ttdeci">#define MAX_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00025">parameter.h:25</a></div></div>
<div class="ttc" id="aparameter_8h_html_aaf01a8b5289af20025d06e3fed70cc94"><div class="ttname"><a href="parameter_8h.html#aaf01a8b5289af20025d06e3fed70cc94">POW_DIM</a></div><div class="ttdeci">#define POW_DIM</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00040">parameter.h:40</a></div></div>
<div class="ttc" id="aparameter_8h_html_ac25189db92959bff3c6c2adf4c34b50a"><div class="ttname"><a href="parameter_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a></div><div class="ttdeci">#define DIM</div><div class="ttdoc">Dimension of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00038">parameter.h:38</a></div></div>
<div class="ttc" id="astruct_curve_html_a4269858acf8d67e3cd222466771848b9"><div class="ttname"><a href="struct_curve.html#a4269858acf8d67e3cd222466771848b9">Curve::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00203">parameter.h:204</a></div></div>
<div class="ttc" id="astruct_curve_html_a4269858acf8d67e3cd222466771848b9a5a99c9b25c007209b664b9d9742a93de"><div class="ttname"><a href="struct_curve.html#a4269858acf8d67e3cd222466771848b9a5a99c9b25c007209b664b9d9742a93de">Curve::lebesgue</a></div><div class="ttdeci">@ lebesgue</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00205">parameter.h:205</a></div></div>
<div class="ttc" id="astruct_curve_html_a4269858acf8d67e3cd222466771848b9aa4755aa9be875092afb3b8ec3fe8599a"><div class="ttname"><a href="struct_curve.html#a4269858acf8d67e3cd222466771848b9aa4755aa9be875092afb3b8ec3fe8599a">Curve::hilbert</a></div><div class="ttdeci">@ hilbert</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00206">parameter.h:205</a></div></div>
<div class="ttc" id="astruct_entry_html_a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26"><div class="ttname"><a href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa029d7bbe93c89623250d346a34f0db26">Entry::z</a></div><div class="ttdeci">@ z</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00258">parameter.h:258</a></div></div>
<div class="ttc" id="astruct_entry_html_a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4"><div class="ttname"><a href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfa3639359c0c3258ebbf403036b4b1d5b4">Entry::x</a></div><div class="ttdeci">@ x</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00254">parameter.h:254</a></div></div>
<div class="ttc" id="astruct_entry_html_a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b"><div class="ttname"><a href="struct_entry.html#a1cfdb441b3e1d3be86d339cf45f940bfacb2115af8a8913b9adf519ae9f89657b">Entry::y</a></div><div class="ttdeci">@ y</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8h_source.html#l00256">parameter.h:256</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
    milupHPC  - src/subdomain_key_tree/tree.cu Source File<br />
    Generated on Tue Feb 15 2022 17:15:51 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.9.3
  </small></address>
</body>
<footer>
  <custom-footer color="white" background="#2E4053">
    <div first>first: more content to add</div>
    <div second>second: bla bla bla</div>
    <div third>third: more content to add</div>
  </custom-footer>
</footer>
<!--
<script src="components/side-nav/runtime.js" type="module"></script><script src="components/side-nav/polyfills.js" type="module"></script><script src="components/side-nav/main.js" type="module"></script>
-->
<script src="components/hamburger/runtime.js" type="module"></script><script src="components/hamburger/polyfills.js" type="module"></script><script src="components/hamburger/main.js" type="module"></script>
<script src="components/header/runtime.js" type="module"></script><script src="components/header/polyfills.js" type="module"></script><script src="components/header/main.js" type="module"></script>
<script src="components/icons/runtime.js" type="module"></script><script src="components/icons/polyfills.js" type="module"></script><script src="components/icons/main.js" type="module"></script>
<script src="components/footer/runtime.js" type="module"></script><script src="components/footer/polyfills.js" type="module"></script><script src="components/footer/main.js" type="module"></script>
<script src="components/dialog/runtime.js" type="module"></script><script src="components/dialog/polyfills.js" type="module"></script><script src="components/dialog/main.js" type="module"></script>
<script src="components/copyable/runtime.js" type="module"></script><script src="components/copyable/polyfills.js" type="module"></script><script src="components/copyable/main.js" type="module"></script>
<script>
  function toggle() {
    var elem = document.getElementById("side-nav");
    console.log(elem);
    elem.toggleSideNav(false);
  }
</script>
<!--
<script>
  function topFunction() {
    document.body.scrollTop = 0; // For Safari
    document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
  }
</script>
-->
</html>